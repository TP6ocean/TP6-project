var document_qwiz_declined_login_b="not ready",document_qwiz_user_logged_in_b="not ready",document_qwiz_maker_privileges=!1,qjax_bypass="not ready",qwiz_wp_site_url,document_qwiz_remember_f=!1,document_active_qwiz_qdeck="",document_qwiz_username="",document_qwiz_independent_taker_f="",document_qwiz_email="",default_document_qwiz_email_confirm=1,document_qwiz_email_confirm=default_document_qwiz_email_confirm,$dialog_current_password="",document_qwiz_class_id="",document_qwiz_session_id,document_qwiz_login_timeout,document_qwiz_team_b=!1,document_qwiz_mobile_enabled="Enabled",document_qwiz_mobile="",document_qwiz_bubblebar_enabled_b=!0,document_qwiz_force_mobile_f=!1,document_qwiz_qdeck_maker_ids={},document_qwiz_pay_registration_date_unix=0,document_qwiz_not_logged_in_alerted=!1,document_qwiz_preview_i_qwiz,document_qwiz_preview_i_deck;qwiz_qcards_common={};var qwiz_qcards_common_f=function(){var qqc=this,qqcname="qwiz_qcards_common";"undefined"==typeof jQuery&&alert("jQuery JavaScript library not loaded.  Use Settings > Qwizcards > Force jQuery load\nto enable quizzes and flashcards");var $=jQuery,init_enter_intercept_f,jjax_script_no=0,head="not ready",server_loc="not ready",secure_server_loc,qwiz_ajaxurl="not ready",plugin_url="",icon_expand_src="not ready",icon_collapse_src,use_dataset_options_html={},use_dataset_options_display_name={},progress_bars_leaderboard={},refresh_leaderboard_timeout={},dataset_questions_countdown_timeout={},pay_qwiz_qdeck_,pay_i_qwiz_deck,payment_received_f=!1,register_taker_global_reg_code_ok_f=!1,register_taker_display_pay_screen_f=!1,register_taker_global_username,register_taker_global_first_name,register_taker_global_last_name,register_taker_global_sha3_password,register_taker_global_username_unique_f,register_taker_global_email_unique_f,register_taker_global_reg_code_maker_id="",register_taker_global_reg_code_school_id="",register_taker_global_reg_code_class_id="",register_taker_global_reg_code_class_name="",register_taker_global_reg_code_school_name="",register_taker_global_in_process_b=!1,provide_feedback_html={},debug=[],update_email_data,enroll_reg_code_ok_f,enroll_reg_code_school_id,enroll_reg_code_school_name,enroll_reg_code_class_id,enroll_reg_code_class_name,global_data_urls,global_blob_urls,number_word;function qjax_callback(js){debug[0]&&console.log("[qjax_callback] js:",js),js&&(js=js.replace(/var /g,""),eval(js))}function check_maker_session_id(){var e=$.cookie("maker_session_id");if(debug[0]&&console.log("[check_maker_session_id] cookie_session_id:",e),e){var t={cookie_session_id:e,callback:"maker_session_id_ok_or_no"};qqc.qjax("qwiz_qcards_common",0,"","check_maker_session_id",t)}else qqc.maker_session_id_ok_or_no()}function set_pay_unlock_menu(e,t,s,i,r,a,o,_,n){var c,d,l,u="";"qwiz_"==e?(c="quiz",d="qwiz",l="qwiz_"):(c="flashcard deck",d="qdeck",l="qcard_"),u+='<div class="pay_preview_status">'+i+"</div>";var p=!1;if(!0===document_qwiz_user_logged_in_b)"paid"!=get_qwizdeckdata(e,t,"pay_quiz_ok")&&(a.length?(u+=r+a.join(""),u+='<a href="javascript: '+e+".hide_menu_and_display_login ("+t+", false, 'pay', '', 0, '"+(m=o?"Sign up":"Pay now")+'\')" class="qwiz_pay_unlock_menu_pay_now">'+m+"</a>"):1==document_qwiz_school_id?u+="Please contact the maker of this "+c+": they need to provide an individual-student payment option for you":u+="Please talk to your teacher: they need to provide access to this "+c+" for you");else if(!s){var h="?url="+encodeURIComponent(qqc.get_qwiz_param("url","./"))+"&qname="+l+"&i_qwiz="+t,g=qqc.get_qwiz_param("secure_server_loc","https://qwizcards.com/admin")+"/register_v2"+h,q='Log in or <a href="'+g+'" target="_blank">register</a> for access';if(u+="<div><b>Students in a teacher&rsquo;s class</b>: Use your teacher&rsquo;s registration code to <a href=\"javascript: qwiz_qcards_common.pay_unlock_menu_display_login ('"+e+"', "+t+", 'register', '"+btoa(q)+'\')" class="qwiz_login">'+qqc.T("register")+"</a>. ",a.length){u+="<br />"+r+a.join("");var m=o?"Sign up":"Pay now";u+="<a href=\"javascript: qwiz_qcards_common.pay_unlock_menu_display_login ('"+e+"', "+t+", '', '"+btoa(q)+'\')" class="qwiz_login qwiz_pay_unlock_menu_pay_now">'+m+"</a>"}u+="</div>",_.length&&(u+="<div><b>Teachers</b>: "+_.join("<br />"),n&&(qqc.maker_logged_in_b||(p=!0),u+='<br /><a href="'+(g="javascript: "+e+".hide_menu_and_display_login ("+t+", false, 'maker_pay')")+'" class="teacher_subscriptions qwiz_login" data-query_string="'+h+'" target="_blank">Teacher subscriptions</a>')),u+="</div>"}return $("div#pay_unlock_menu-"+d+t).html(u),p}function get_dataset_units_topics(e,t,s,i,r){var a="";void 0!==document_qwiz_session_id&&(a=document_qwiz_session_id);var o={qname:e,i_qwiz_qdeck:t,dataset:i,qwiz_session_id:a};r&&(o.callback=r),qqc.qjax(e,t,s,"get_dataset_units_topics",o)}function resize_feedback_images(e){$(e).find("img").each(function(){if(!this.qwiz_sizing){var e,t=$(this),s=parseInt(t.parents("div.qwiz-provide_feedback").width()),i=parseInt(t.width());debug[0]&&console.log("[resize_feedback_images] img_width:",i,", container_width:",s),e=i==s?1:1/window.devicePixelRatio;var r=parseInt(i*e),a=parseInt(t.height()*e);t.css({cssText:"border:  1px solid gray !important",width:r+"px",height:a+"px",margin:"0 5px 5px 0",float:"left"}),this.qwiz_sizing=1}})}function submit_feedback2(e,t,s,i,r){if(r){debug[0]&&console.log("[submit_feedback2] global_data_urls[0].substr (0, 50):",global_data_urls[0].substr(0,50));for(var a=r.length,o=0;o<a;o++)i=i.replace(r[o],'<img src="'+global_data_urls[o]);debug[0]&&console.log("[submit_feedback2] feedback_html.length:",i.length)}var _,n,c,d;if("qwiz_"==e?(_="div#qwiz"+t,n="qwiz",c=qwiz_.get_qwizdata,d=$("div.header-qwiz"+t).html()):(_="div.qcard_card-qdeck"+t,n="qdeck",c=qcard_.get_deckdata,d=$("div#qcard_header-qdeck"+t).html()),provide_feedback_html[_]=i,i.length>25e6)return alert("Sorry, your feedback is too big (large images). Please use smaller/fewer images."),!1;var l=c(t,"qrecord_id"),u=document_qwiz_qdeck_maker_ids[n+t],p={feedback_html:i,page_url:window.location.href,user_agent:navigator.userAgent,qwiz_qcard:_,qname:e,header_html:d,i_qwiz:t,i_question:s,maker_id:u,taker_username:document_qwiz_username,taker_email:document_qwiz_email};qqc.jjax(e,t,l,"receive_feedback",p)}function get_blobs_as_data_urls(e,t,s,i,r,a){i--;var o=new XMLHttpRequest;o.responseType="blob",o.onload=function(){var _=o.response,n=new FileReader;n.onload=function(){debug[0]&&console.log("[get_blobs_as_data_urls] i_do:",i,", reader.result.length:",n.result.length),global_data_urls.push(n.result),0==i?submit_feedback2(e,t,s,r,a):get_blobs_as_data_urls(e,t,s,i,r,a)},n.readAsDataURL(_)},o.open("GET",global_blob_urls[i]),o.send()}function qwiz_deck_selector(e,t){return("qwiz_"==e?"div#qwiz"+t:"div.qcard_card-qdeck"+t)+" "}function register_taker_registered_feedback(e,t,s,i){(debug[0]&&console.log("[register_taker_registered_feedback] qname:",e),i)?("qwiz_"==e?qwiz_:qcard_).display_login(t,!1,"pay"):(htm=[],s?(htm.push("<p>"),htm.push("<b>Thank you for using Qwizcards.</b>"),htm.push("</p>"),htm.push("<p>"),htm.push("You are now logged in to quizzes and flashcard decks that"),htm.push("have been set up to record activity.&nbsp;"),htm.push("In the future, use the pull-down triangle on each quiz or deck to log in."),htm.push("</p>"),htm.push("<p>"),htm.push("The green triangle also gives you a menu option to view your progress on quizzes and flashcard decks."),htm.push("</p>"),htm.push("<p>")):(htm.push("<br />"),htm.push("<br />"),htm.push("<p>"),htm.push("<b>Thank you.&nbsp; You are now registered for class "+register_taker_global_reg_code_class_name+", "+register_taker_global_reg_code_school_name+"</b>"),htm.push("</p>"),htm.push("<p>"),htm.push("When you do a quiz or flashcard deck, be sure to log in (under the"),htm.push("pull-down triangle icon on each quiz or deck)."),htm.push("</p>")),htm.push('<button class="qwiz_button" onclick="'+e+".login_ok ("+t+', 0, 1)">'),htm.push("Continue"),htm.push("</button>"),qqc.$get_login_div(e,t).html(htm.join("\n")).show());return!1}function extract_delete_shortcode_content(e,t,s,i){for(var r=[],a="["+t+"]",o="[/"+t+"]";;){var _=e.indexOf(a);if(-1==_)break;if(e.indexOf(o)<_)i.additional_errmsgs.push(a+" "+qqc.T("found, but not")+" "+o);else{var n=new RegExp("(<[^\\/][^>]*>\\s*)*?\\["+t+"\\]([\\s\\S]*?)\\[\\/"+t+"\\]((<\\/[^>]+>\\s*)*)","m"),c=e.substr(_).match(n);r.push(c[2]),e=e.replace(n,"")}if(!s)break}return{htm:e,content:r=r.length?r.join(""):"NA"}}function add_span_if_empty(e,t){t||-1!=e.search(/\S/)?-1==e.replace(/&nbsp;|&ensp;|&emsp;|&thinsp;|&hairsp;/,"").search(/\S/)&&(e+='<span class="qwiz-avoid-br" style="display: none;">x</span>'):e="";return e}debug[0]=!1,debug[5]=!1,debug[7]=!1,debug[9]=!1,debug[10]=!1,debug[11]=!1,debug[12]=!1,$(document).ready(function(){$.cookie&&(document_qwiz_declined_login_b=$.cookie("qwiz_declined_login")),head=document.getElementsByTagName("head")[0],debug[0]&&console.log("[qwiz_qcards_common ready] head:",head);var e=$("a.unit.unit_button"),t=e.html();if(t&&"start course"==t.toLowerCase()){var s=function(){$("div.qwiz_wrapper_fallback").is(":visible")&&qwiz_.qwiz_init(),$("div.qdeck_wrapper_fallback").is(":visible")&&qcard_.qdeck_init()};e.click(function(){setTimeout(s,3e3)})}}),this.jjax=function(e,t,s,i,r){return qqc.qjax(e,t,s,i,r),!1},this.qjax=function(e,t,s,i,r){if(r||(r={}),r.qname=e,r.i_qwiz=t,r.qrecord_id=s,r.dest=i,r.js_f=1,void 0!==document_qwiz_session_id&&(r.qwiz_session_id=document_qwiz_session_id),debug[0]&&console.log("[qjax] qwizdata:",r),"not ready"==qjax_bypass&&(qjax_bypass=qqc.get_qwiz_param("qjax_bypass",""),qwiz_wp_site_url=qqc.get_qwiz_param("wp_site_url","")),qjax_bypass){var a=qwiz_wp_site_url+"/admin/"+i;debug[0]&&console.log("[qjax] url:",a),$.ajax({type:"POST",url:a,data:r,error:function(s,i,o){var _;console.log("[qjax] XMLHttpRequest:",s,", statusText:",i,", errorThrown:",o),console.log("[qjax] url:",a);var n=s.readyState;-1!=a.indexOf("record")?("qwiz_"==e?$("span.response_recorded-qwiz"+t).hide():$("span.response_recorded-qdeck"+t).hide(),_=0==n?r.secure_f?"Sorry, unable to record your response.  Please try again.  Perhaps check your Internet connection?":"Sorry, unable to record your response.  Perhaps check your Internet connection?":r.secure_f?"Sorry, unable to record your response.  Please try again.  If the problem reoccurs, contact support@qwizcards.com":"Sorry, unable to record your response.  If the problem reoccurs, please contact support@qwizcards.com"):_=0==n?"Sorry, unable to process request.  Perhaps check your Internet connection?":"Sorry, unable to process request.  If the problem persists, please contact support@qwizcards.com",alert(_)},success:qjax_callback})}else{"not ready"==qwiz_ajaxurl&&(qwiz_ajaxurl=qqc.get_qwiz_param("ajaxurl",""));var o={action:"qjax"};o.qwizdata=btoa(encodeURIComponent(JSON.stringify(r))),$.ajax({type:"POST",url:qwiz_ajaxurl,data:o,success:qjax_callback})}},this.check_session_id=function(e){var t=$.cookie("qwiz_session_id");if(debug[0]&&console.log("[check_session_id] cookie_session_id:",t),t){document_qwiz_session_id=t;var s={cookie_session_id:t};qqc.qjax("",e,"","check_session_id",s)}else document_qwiz_user_logged_in_b=!1},this.maker_session_id_ok_or_no=function(){if(!qqc.maker_logged_in_b){setTimeout(function(){$("a.teacher_subscriptions").each(function(){var e=$(this),t=e.data("query_string");debug[0]&&console.log("[maker_session_id_ok_or_no]: query_string:",t);var s=qqc.get_qwiz_param("secure_server_loc","https://qwizcards.com/admin")+"/maker_login_register"+t;e.attr("href",s)})},250)}},this.set_user_menus_and_icons=function(e,t){var s,i="";if(!0===document_qwiz_user_logged_in_b){var r=document_qwiz_maker_privileges?"Teacher logged in as student":"Logged in as";if(i+='<div style="text-align: right;">'+qqc.T(r)+" <strong>"+document_qwiz_username+"</strong></div>",document_qwiz_maker_privileges&&!qwiz_.preview_i_qwiz_plus1&&!qcard_.preview_ideck_plus1){i+='<div class="teacher_preview_qname"><a href="javascript: qwiz_qcards_common.do_preview (i_qwiz)" title="View this quiz/deck in expanded, all-question display">'+qqc.T("Teachers only: preview this quiz_flashcard_deck")+"</a></div>"}i+=document_qwiz_independent_taker_f?'<div><a href="javascript: qname.hide_menu_and_display_login (i_qwiz, false, \'enroll\')" title="You are currently registered as an independent student.  If you have a registration code you can join a class">'+qqc.T("Enroll in a school/class")+"</a></div>":'<div><a href="javascript: qname.hide_menu_and_display_login (i_qwiz, true)">'+qqc.T("Add team member")+"</a></div>","not ready"==server_loc&&(server_loc=qqc.get_qwiz_param("server_loc","http://qwizcards.com/admin")),i+='<div><a href="'+server_loc+"/index?student_view=1&time="+document_qwiz_session_id+'" target="_blank">'+qqc.T("My scores")+"</a></div>",i+="<div><nobr><a href=\"javascript: qname.hide_menu_and_display_login (i_qwiz, false, 'progress_bars')\">"+qqc.T("My progress")+"</a>/<a href=\"javascript: qname.hide_menu_and_display_login (i_qwiz, false, 'leaderboard')\">"+qqc.T("Leaderboard")+"</a></nobr></div>",i+='<div><a href="'+server_loc+"/my_account?time="+document_qwiz_session_id+'" target="_blank" title="'+qqc.T("View/edit login name, password, ...")+'">'+qqc.T("My account - settings")+"</a></div>",i+='<div><a href="javascript: qname.hide_menu_and_display_login (i_qwiz, false, \'feedback\')" title="'+qqc.T("Report errors/bugs, comment, make suggestions...")+'">'+qqc.T("Feedback")+"</a></div>",i+="<div>"+qqc.T("Not")+" "+document_qwiz_username+'? <a href="javascript: '+qqcname+'.sign_out ()">'+qqc.T("Sign out")+"</a></div>",s=document_qwiz_maker_privileges?"#00b8ff":"#20a020",$("div.qwiz-usermenu_icon").removeClass("qwiz-icon-bounce")}else i+='<br /><div><nobr><a href="javascript: qname.hide_menu_and_display_login (i_qwiz)"><strong>'+qqc.T("Log in")+"</strong> "+qqc.T("to record/get credit")+"</a></nobr></div>",i+='<div> <span class="qwiz-remember" title="'+qqc.T("Skip login in the future")+'"><label class="qwiz_label"><span><input type="checkbox" /></span> '+qqc.T("Remember")+'</label></span> &nbsp;<a href="javascript: qname.icon_no_login (i_qwiz)"><strong>'+qqc.T("No thanks")+"</strong></a></div>",i+="<div><br /><a href=\"javascript: qname.hide_menu_and_display_login (i_qwiz, false, 'leaderboard')\">"+qqc.T("Leaderboard")+"</a></div>",s="black","not ready"==document_qwiz_declined_login_b&&(document_qwiz_declined_login_b=$.cookie("qwiz_declined_login")),e||document_qwiz_declined_login_b||($("div.qwiz-usermenu_icon_no_intro").addClass("qwiz-icon-bounce"),$("div.qwiz-usermenu_icon").addClass("qwiz-icon-bounce"));var a=i.replace(/qname/g,"qwiz_").replace(/quiz_flashcard_deck/g,"quiz");$("div.qwiz-usermenu").each(function(){var e=$(this).attr("id").substr(13);$(this).html(a.replace(/i_qwiz/g,e))});var o=i.replace(/qname/g,"qcard_").replace(/quiz_flashcard_deck/g,"flashcard deck");$("div.qdeck-usermenu").each(function(){var e=$(this).attr("id").substr(14);$(this).html(o.replace(/i_qwiz/g,e))}),$("div.qwiz-usermenu_icon").css({display:"block",color:s}),$qscores=$("span.qscores"),$qscores.length&&qqc.set_qscore_menus($qscores)},this.do_preview=function(e){$.cookie("qwiz_preview",e,{path:"/"});var t=document.location.href;window.open(t,"preview_qwiz_window")},this.pay_unlock_menu_display_login=function(e,t,s,i){var r,a;"qwiz_"==e?(r="qwiz",a=qwiz_):(r="qdeck",a=qcard_);var o=$("div.qwiz_icon_and_menu_container."+r+t);o.css({"z-index":"-1"}),a.display_login(t,!1,s,atob(i),1);setTimeout(function(){o.css({"z-index":""})},100)},this.sign_out=function(e,t){$.removeCookie("qwiz_session_id",{path:"/"}),document_qwiz_user_logged_in_b=!1,document_qwiz_maker_privileges=!1,document_qwiz_email="",document_qwiz_email_confirm=default_document_qwiz_email_confirm;var s={session_id:document_qwiz_session_id="",table:"session_id"};qqc.qjax("",-1,"","delete_session_id",s),qqc.set_user_menus_and_icons(!e,t),qwiz_&&qwiz_.any_pay_quiz_f&&qwiz_.pay_lock_settings(),qcard_&&qcard_.any_pay_deck_f&&qcard_.pay_lock_settings(),document_qwiz_pay_registration_date_unix=0},this.usermenu_pay=function(e,t){"qwiz_"==e?$("div.qwiz-progress-container.qwiz"+t).find("a.qwiz_pay_unlock_menu_pay_now")[0].click():$("div#qcard_progress-qdeck"+t).find("a.qwiz_pay_unlock_menu_pay_now")[0].click()},this.set_qscore_menus=function(e){var t;"not ready"==server_loc&&(server_loc=qqc.get_qwiz_param("server_loc","http://qwizcards.com/admin"),secure_server_loc=qqc.get_qwiz_param("secure_server_loc","https://host359.hostmonster.com/~whereisq/qwiz/admin")),!0===document_qwiz_user_logged_in_b?(t='<a href="'+secure_server_loc+"/index.php?student_view=1&time="+document_qwiz_session_id+'" target="_blank">',t+=qqc.T("View scores")):(t='<a href="'+secure_server_loc+'/student_login.php" target="_blank">',t+=qqc.T("Login/View scores")),t+="</a>",e.html(t)},this.create_progress_bars=function(e,t,s,i){progress_bars_leaderboard[e+s]=i,plugin_url||(plugin_url=qqc.get_qwiz_param("url","./"));var r='<img src="'+(plugin_url+"images/spinner40x40.gif")+'" class="qwiz-center" style="margin-top: 100px;" />';e&&qqc.$get_login_div(e,s).html(r).show();if(!0!==document_qwiz_user_logged_in_b){var a={not_logged_in_f:1,qname:e,i_qwiz:s,qrecord_id:t[s].qrecord_id};return qqc.create_progress_bars3(a),!1}if(t[s].record_start_b&&!0===document_qwiz_user_logged_in_b){t[s].record_start_b=!1;var o=(new Date).getTime()/1e3,_=(a={qrecord_id_ok:t[s].qrecord_id_ok,type:"start",now_sec:o,callback:"create_progress_bars2"},"qwiz_"==e?"record_response_v3":"record_qcard_v2");qqc.qjax(e,s,t[s].qrecord_id,_,a)}else qqc.create_progress_bars2(e,s,t[s].qrecord_id)},this.create_progress_bars2=function(e,t,s){document_qwiz_independent_taker_f&&(document_qwiz_class_id="independent_student");var i=get_qwizdeckdata(e,t,"use_dataset");if(i)get_dataset_units_topics(e,t,s,i,"create_progress_bars3");else{var r,a;if("qwiz_"==e)a=qwiz_.get_qwizdata(t,"n_questions"),r=qwiz_.get_qwizdata(t,"n_correct");else r=(a=qcard_.get_deckdata(t,"n_cards"))-qcard_.get_deckdata(t,"n_to_go");var o={qname:e,i_qwiz_qdeck:t,qrecord_id:s,units:[""],n_correct_by_unit_topic:[r],n_questions_by_unit_topic:[a]};qqc.create_progress_bars3(o)}},this.create_progress_bars3=function(e){debug[12]&&console.log("[create_progress_bars3] data:",e);var t,s=document_qwiz_user_logged_in_b,i=e.qname,r=e.i_qwiz_qdeck,a=e.qrecord_id;if(s){var o=e.units,_=e.n_correct_by_unit_topic,n=e.n_questions_by_unit_topic;t=o.length;for(var c=0,d=0,l=0;l<t;l++)c+=_[l],d+=n[l]}var u=[];if(u.push('<div id="progress_bars_leaderboard_tabs_'+i+r+'" class="progress_bars_leaderboard_tabs">'),u.push("<ul>"),s&&(u.push("<li>"),u.push('<a href="#progress_bars_tab_'+i+r+'">'),u.push("Progress"),u.push("</a>"),u.push("</li>")),u.push("<li>"),u.push('<a href="#leaderboard_tab_'+i+r+'">'),u.push("Leaderboard"),u.push("</a>"),u.push("</li>"),u.push("</ul>"),s){u.push('<div id="progress_bars_tab_'+i+r+'">'),u.push('<table class="unit_progress_bars">');var p=!1;for(l=0;l<t;l++)"Other"!=o[l]&&"(excluded)"!=o[l]&&(p=!0);if(p)for(l=0;l<t;l++){if("(excluded)"!=o[l]){var h=_[l]+"/"+n[l];u.push("<tr>"),u.push("<td>"),u.push(o[l]),u.push("</td>"),u.push("<td>");var g="unit_progress_bar-"+i+r+"-unit"+l;u.push('<div id="'+g+'" class="unit_progress_bars"><div class="progress-label"></div></div>'),u.push("</td>"),u.push("</tr>")}}t&&(u.push("<tr>"),u.push('<td colspan="2">'),u.push('<hr style="margin: 2px 0 0;" />'),u.push("</td>"),u.push("</tr>")),u.push("<tr>"),u.push("<td>"),"qwiz_"==i?u.push("<b>Whole quiz</b>"):"qcard_"==i?u.push("<b>Whole deck</b>"):document_qwiz_independent_taker_f?u.push("<b>All quizzes/decks tried</b>"):u.push("<b>Course</b>"),u.push("</td>"),u.push("<td>");g="course_progress_bar-"+i+r;u.push('<div id="'+g+'" class="unit_progress_bars"><div class="progress-label"></div></div>'),u.push("</td>"),u.push("</tr>"),u.push("</table>"),u.push('All work: <a href="'+server_loc+"/index?student_view=1&time="+document_qwiz_session_id+'" style="color: blue;" target="_blank">'),u.push(qqc.T("My scores")+"</a>"),u.push('<button class="qwiz_button exit_progress_bars" style="float: right;" onclick="'+i+".no_login ("+r+', false, true, event)">'),u.push("Continue"),u.push("</button>"),u.push("</div>")}u.push('<div id="leaderboard_tab_'+i+r+'" class="leaderboard">'),u.push("</div>"),u.push("</div>"),$(i?"qwiz_"==i?"#qwiz_login-qwiz"+r:"div.qcard_card-qdeck"+r+" div.qcard-front div.qcard_content_size":"#progress_bars"+r).html(u.join("\n")).show();var q=0;if("leaderboard"==progress_bars_leaderboard[i+r]&&(q=1,qqc.qjax(i,r,a,"get_leaderboard_data","")),$("#progress_bars_leaderboard_tabs_"+i+r).tabs({active:q,activate:function(e,t){t.newPanel.hasClass("leaderboard")&&"\n"==t.newPanel.html()&&(debug[12]&&console.log("[create_progress_bars3 > leaderboard activate] qrecord_id:",a),qqc.qjax(i,r,a,"get_leaderboard_data",""))}}),s){if(t>1)for(l=0;l<t;l++){if("(excluded)"!=o[l]){var m=parseInt(100*_[l]/n[l],10),w=$("#unit_progress_bar-"+i+r+"-unit"+l);w.progressbar({value:m});h=_[l]+"/"+n[l];w.find("div.progress-label").text(h)}}var f=$("#course_progress_bar-"+i+r);m=parseInt(100*c/d,10);f.progressbar({value:m});h=c+"/"+d;f.find("div.progress-label").text(h)}},this.create_leaderboard_html=function(e){debug[12]&&console.log("[create_leaderboard_html] data:",e);var t=e.qname,s=e.i_qwiz,i=e.qrecord_id,r=(e.n_questions,e.opt_out_f),a=e.takers,o=e.refresh_sec,_=[];for(var n in a){var c=a[n],d=c.username,l=0,u=0,p=0;c.start&&(l=c.start),c.completed&&c.completed,c.n_correct&&(u=c.n_correct,p=c.first_correct),l||(l=p);var h,g="";_.push([h,d,u,g])}_.sort(function(e,t){return t[2]-e[2]}),debug[12]&&console.log("[create_leaderboard_html] leaderdata:",_);var q=_.length,m=[];if(0==q)return m.push("<br /><h3>[No recent data available]</h3><br />"),m.push('<button class="qwiz_button exit_progress_bars" style="float: right;" onclick="'+t+".no_login ("+s+', false, true, event)">'),m.push("Continue"),m.push("</button>"),void $("#leaderboard_tab_"+t+s).html(m.join("\n"));m.push('<div style="max-height: 175px; overflow: auto;">'),m.push('<table class="leaderboard">'),m.push("<thead>"),m.push("<th>"),m.push("Name"),m.push("</th>");var w="qwiz_"==t?"correct":"cards";m.push('<th class="qwiz-center">'),m.push("No. "+w),m.push("</th>"),m.push("</thead>"),m.push("<tbody>");for(var f=0;f<q;f++){d=_[f][1].replace(/@.*/,""),m.push("<tr>"),m.push("<td>"),m.push(d),m.push("</td>");u=_[f][2],g=_[f][3];m.push('<td class="qwiz-center">'),m.push(u),m.push("</td>"),m.push("   </tr>")}m.push("<tbody>"),m.push("</table>"),m.push("</div>"),m.push('<div class="refresh_leaderboard">'),m.push("Refresh every"),m.push('<select onchange="'+qqcname+".refresh_leaderboard_change (this, '"+t+"', "+s+", '"+i+"')\">");var b=["","5","10","15","30","60"],v=b.length;for(f=0;f<v;f++){var k=o==b[f]?" selected":"";m.push('<option value="'+b[f]+'"'+k+">"),m.push(b[f]),m.push("</option>")}if(m.push("</select>"),m.push(" seconds"),m.push("</div>"),m.push('<button class="qwiz_button exit_progress_bars" style="float: right;" onclick="'+t+".no_login ("+s+', false, true, event)">'),m.push("Continue"),m.push("</button>"),!0===document_qwiz_user_logged_in_b){var z=r?" checked":"";m.push('<div class="leaderboard_opt_out" title="Do not show your name in list">'),m.push('<label class="qwiz_label">'),m.push('<input type="checkbox" onclick="qwiz_qcards_common.update_leaderboard_opt_out (\''+t+"',"+s+', this)" '+z+" />"),m.push("Opt out"),m.push("</label>"),m.push("</div>"),m.push('<div style="clear: both;"></div>'),m.push('<div id="leaderboard_opt_out_feedback'+t+s+'" class="leaderboard_opt_out_feedback">'),m.push("Preference saved"),m.push("</div>")}$("#leaderboard_tab_"+t+s).html(m.join("\n"))},this.refresh_leaderboard_change=function(e,t,s,i){void 0!==refresh_leaderboard_timeout[s]&&clearTimeout(refresh_leaderboard_timeout[s]);var r=e.value;if(r){var a=function(){qqc.qjax(t,s,i,"get_leaderboard_data",{refresh_sec:r}),refresh_leaderboard_timeout[s]=setTimeout(a,1e3*r)};refresh_leaderboard_timeout[s]=setTimeout(a,1e3*r)}},this.update_leaderboard_opt_out=function(e,t,s){var i=s.checked?1:0;qqc.qjax(e,t,"","update_leaderboard_opt_out",{opt_out_f:i})},this.create_use_dataset_options=function(e,t,s){"qwiz_"==e?$("#progress-qwiz"+s).html(""):$("#progress-qdeck"+s).html(""),plugin_url||(plugin_url=qqc.get_qwiz_param("url","./"));var i='<img src="'+(plugin_url+"images/spinner40x40.gif")+'" class="qwiz-center" style="margin-top: 100px;" />';qqc.$get_login_div(e,s).html(i).show(),use_dataset_options_html[e+s]=t[s].use_dataset_options_html,use_dataset_options_display_name[e+s]=t[s].use_dataset_options_display_name,qrecord_id=t[s].qrecord_id;var r=t[s].use_dataset;if(t[s].record_start_b&&!0===document_qwiz_user_logged_in_b){t[s].record_start_b=!1;var a=(new Date).getTime()/1e3,o={qrecord_id_ok:t[s].qrecord_id_ok,type:"start",now_sec:a,dataset:r,callback:"create_use_dataset_options2"},_="qwiz_"==e?"record_response_v3":"record_qcard_v2";qqc.qjax(e,s,qrecord_id,_,o)}else qqc.create_use_dataset_options2(e,s,r,qrecord_id)},this.create_use_dataset_options2=function(e,t,s,i){if(debug[11]&&console.log("[create_use_dataset_options2] dataset:",s,", qrecord_id:",i),use_dataset_options_html[e+t]&&!0!==document_qwiz_user_logged_in_b)return qqc.create_use_dataset_options3("",e,t),!1;get_dataset_units_topics(e,t,i,s)},this.create_use_dataset_options3=function(e,t,s){if(debug[11]&&console.log("[create_use_dataset_options3] data:",e),t)return(u=qqc.$get_login_div(t,s)).html(use_dataset_options_html[t+s]).show(),!1;t=e.qname,s=e.i_qwiz_qdeck;var i,r=e.qrecord_id,a=e.dataset,o=e.units,_=e.topics,n=e.n_questions_by_unit_topic,c=e.n_correct_by_unit_topic,d=o.length,l=e.dataset_reset_questions_date,u=qqc.$get_login_div(t,s);if(e.errmsg)return u.html("<br /><b>"+e.errmsg+"</b>").show(),!1;if(0==d)return i="qwiz_"==t?"You have completed all questions correctly":"You have marked all cards &ldquo;Got-it&rdquo;",u.html("<br /><b>"+i+"</b>").show(),!1;var p={},h={},g={},q={},m=!0,w={},f=0;(N=o[d-1])||(N="Other");for(var b=0,v=0,k=0,z=d-1;z>=0;z--){var y=null===c[z]?0:parseInt(c[z],10);if(o[z]||(o[z]="Other"),_[z]||(_[z]="Other"),p[T=(T=o[z]+"__"+_[z]).replace(/[^a-z0-9]/gi,"_")]=n[z],h[T]=y,o[z]!=N){var x=N.replace(/[^a-z0-9]/gi,"_");g[x]=b,q[x]=v,"Other"!=N&&(m=!1),w[x]=0==k,b=0,v=0,k=0,N=o[z]}b+=parseInt(n[z],10),v+=y,"Other"!=_[z]&&k++,f+=n[z]}g[S=o[0].replace(/[^a-z0-9]/gi,"_")]=b,q[S]=v,"Other"!=o[0]&&(m=!1),w[S]=0==k;u=qqc.$get_login_div(t,s);if(use_dataset_options_html[t+s]){for(var S in u.html(use_dataset_options_html[t+s]).show(),$("#dataset_units_topics-"+t+s+" td.nquestions").html("0"),$("#dataset_units_topics-"+t+s+" td.ncorrect").html("0"),g)$("#dataset_units_topics-"+t+s+" td.nquestions."+S).html(g[S]),$("#dataset_units_topics-"+t+s+" td.ncorrect."+S).html(q[S]);for(var T in p)$("#dataset_units_topics-"+t+s+" td.nquestions."+T).html(p[T]),$("#dataset_units_topics-"+t+s+" td.ncorrect."+T).html(h[T]);return!1}"not ready"==icon_expand_src&&(plugin_url||(plugin_url=qqc.get_qwiz_param("url","./")),icon_expand_src=plugin_url+"images/icon_expand.gif",icon_collapse_src=plugin_url+"images/icon_collapse.gif");var C=[],j=a;use_dataset_options_display_name[t+s]&&(j=use_dataset_options_display_name[t+s]);var A="topics_only"==get_qwizdeckdata(t,s,"dataset_intro_f"),O=get_qwizdeckdata(t,s,"dataset_intro_info_only_msg"),E="qwiz_"==t?"questions":"cards";if(O&&C.push('<span class="qwiz_errmsg">'+O+"</span><br />"),C.push('<div class="use_dataset_options_header">'+j+"</div>"),m&&w.Other){M=p.Other__Other,R=h.Other__Other;C.push("<br /><br />"),"qwiz_"==t?(C.push("<b>Questions: "+M),r&&!0===document_qwiz_user_logged_in_b&&C.push("&ensp; Correct: "+R),C.push("</b><br />")):(C.push("<b>Cards: "+M),r&&!0===document_qwiz_user_logged_in_b&&C.push("&ensp; &ldquo;Got-it&rdquo;: "+R),C.push("</b><br />"))}else{m&&qqc.set_qwizdeckdata(t,s,"expand_topics",!0),A||C.push('<p class="use_dataset_options">Choose the type of '+E+" you want to practice</p>"),C.push('<table id="dataset_units_topics-'+t+s+'" class="dataset_units_topics" align="center">'),C.push("<tr>"),C.push("<th>"),C.push("</th>");var P=A?"hidden":"visible";C.push("<th>"),C.push('<input type="checkbox" onclick="qwiz_qcards_common.dataset_units_topics_toggle_all (this)" style="visibility: '+P+'" checked />'),C.push("</th>"),C.push("<th>"),C.push('<span class="units_header">Unit</span>'),C.push("</th>"),C.push("<th>"),C.push('<span class="topics_header">Topic</span>'),C.push("</th>"),C.push('<th class="qwiz-center">'),"qwiz_"==t?C.push("Qs"):C.push("Cards"),C.push("</th>"),r&&!0===document_qwiz_user_logged_in_b&&(C.push('<th class="qwiz-center">'),"qwiz_"==t?C.push("Correct"):C.push("&ldquo;Got-it&rdquo;"),C.push("</th>")),C.push("</tr>");var N="",I=-1,M=0,R=0;for(z=0;z<d;z++){var B=o[z],H=_[z];if(B!=N){N=B;var L=t+s+"-unit"+ ++I;C.push('<tr id="'+L+'" class="unit_head">');S=B.replace(/[^a-z0-9]/gi,"_");C.push('<td style="padding-right: 5px;">'),w[S]||C.push('<img src="'+icon_expand_src+'" class="expand expand_collapse expand_collapse_unit qwiz-inline" onclick="qwiz_qcards_common.dataset_unit_expand_collapse (\''+t+"', "+s+', this)" title="'+qqc.T("Show/hide topics in this unit")+'" />'),C.push("</td>"),C.push("<td>"),C.push('<input type="checkbox" class="toggle_topics" style="visibility: '+P+'" onclick="qwiz_qcards_common.dataset_unit_toggle_topics (this)" title="'+qqc.T("Select/deselect all topics in this unit")+'" checked />'),C.push("</td>"),C.push('<td colspan="2" class="unit">'),C.push("<b>"),C.push(B.replace(/_/g," ")),C.push("</b>"),C.push("</td>"),C.push('<td class="qwiz-center qwiz-nowrap nquestions '+S+'">'),C.push("<b>"),C.push(g[S]),C.push("</b>"),C.push("</td>"),r&&!0===document_qwiz_user_logged_in_b&&(C.push('<td class="qwiz-center qwiz-nowrap ncorrect '+S+'">'),C.push("<b>"),C.push(q[S]),C.push("</b>"),C.push("</td>")),C.push("</tr>")}C.push('<tr class="unit_topic unit_topic'+I+'" data-unit="'+btoa(B)+'">'),C.push("<td>"),C.push("</td>");var F=t+s+"-unit_topic"+z;C.push("<td>"),C.push('<input type="checkbox" id="'+F+'" style="visibility: '+P+'" checked />'),C.push("</td>"),C.push("<td>"),C.push("</td>"),C.push('<td class="topic" data-topic="'+btoa(H)+'">'),C.push(H.replace(/_/g," ")),C.push("</td>"),T=(T=B+"__"+H).replace(/[^a-z0-9]/gi,"_"),C.push('<td class="qwiz-center qwiz-nowrap nquestions '+T+'">'),C.push(p[T]),C.push("</td>"),M+=p[T],r&&!0===document_qwiz_user_logged_in_b&&(C.push('<td class="qwiz-center qwiz-nowrap ncorrect '+T+'">'),C.push(h[T]),C.push("</td>")),R+=h[T],C.push("</tr>")}C.push('<tr class="border-top">'),C.push("<td>"),C.push("</td>"),C.push("<td>"),C.push("</td>"),C.push('<td colspan="2">'),C.push("<b>"),C.push("Total"),C.push("</b>"),C.push("</td>"),C.push('<td class="qwiz-center qwiz-nowrap">'),C.push("<b>"),C.push(M),C.push("</b>"),C.push("</td>"),C.push('<td class="qwiz-center qwiz-nowrap">'),C.push("<b>"),C.push(R),C.push("</b>"),C.push("</td>"),C.push("</tr>"),C.push("</table>")}if(!O){C.push('<p class="use_dataset_options">');var D="'Redo' - "+E+" done before this date will not be counted in totals";if(C.push("Restart:"),C.push('<input type="date" id="dataset_reset_questions_date_'+t+s+'" class="dataset_reset_questions_date" value='+l+" />"),C.push('<img src="'+plugin_url+'images/info_icon.png" class="qwiz_icon_smaller qwiz-inline" style="cursor: help;" title="'+D+'">'),C.push("&emsp;"),A?C.push(E):C.push(qqc.capitalize(E)+" to practice in this session:"),C.push('<select id="dataset_max_q_'+t+s+'" class="dataset_max_q">'),A)C.push("<option selected>"),C.push(f),C.push("</option>");else{var J=[10,20,30,50,100];debug[11]&&J.unshift(3);var U="",V=J.length;for(z=0;z<V;z++){if(J[z]>=f){U=U?"":" selected",C.push("<option"+U+">"),C.push(f),C.push("</option>");break}30==J[z]&&(U=" selected"),C.push("<option"+U+">"),C.push(J[z]),C.push("</option>")}}C.push("</select>"),D="qwiz_"==t?"Note: questions that you miss will be repeated within this session":"Note: cards that you mark &ldquo;Need more practice&rdquo; will be repeated within this session",C.push('<img src="'+plugin_url+'images/info_icon.png" class="qwiz_icon_smaller qwiz-inline" style="cursor: help;" title="'+D+'">'),C.push("</p>");var W="Begin practice";if(r&&!0===document_qwiz_user_logged_in_b&&!A){var Y;C.push('<span class="use_dataset_options">'),C.push("Do "+E+": &ensp;"),C.push("</span>"),C.push('<label class="qwiz_label use_dataset_options">'),Y="qwiz_"==t?"Priority is questions you answered incorrectly and new questions":"Priority is cards you marked &ldquo;need more practice&rdquo; and new cards;",Y+=", but "+E+" you answered correctly will sometimes be shown for review",C.push('<input type="radio" name="spaced_repetition" class="qwiz_radio_smaller" value="spaced_repetition" checked />Spaced repetition<img src="'+plugin_url+'images/info_icon.png" class="qwiz_icon_smaller qwiz-inline" style="cursor: help;" title="'+Y+'" /> &ensp;'),C.push("</label>"),C.push('<label class="qwiz_label use_dataset_options">'),C.push('<input type="radio" name="spaced_repetition" class="qwiz_radio_smaller" value="new" />New&ensp;'),C.push("</label>"),C.push('<label class="qwiz_label use_dataset_options">');var K="qwiz_"==t?"Incorrect":"&ldquo;Need more practice&rdquo;";C.push('<input type="radio" name="spaced_repetition" class="qwiz_radio_smaller" value="incorrect" />'+K+" &ensp;"),C.push("</label>"),C.push('<label class="qwiz_label use_dataset_options">'),C.push('<input type="radio" name="spaced_repetition" class="qwiz_radio_smaller" value="all" />All'),C.push("</label>"),C.push("<br />")}C.push('<button class="qwiz_button begin_practice" onclick="qwiz_qcards_common.begin_dataset_quiz_deck (\''+a+"', '"+t+"', "+s+", '"+r+"', 0, 0, '"+l+"')\">"),A&&(W="qwiz_"==t?"Start questions":"Start cards"),C.push(W),C.push("</button>"),C.push("<br />"),C.push("<br />")}u.html(C.join("\n")).show(),"qcard_"==t&&qcard_.set_container_width_height(s),-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&$("#dataset_reset_questions_date_"+t+s).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),(A||get_qwizdeckdata(t,s,"expand_topics"))&&$("table#dataset_units_topics-qwiz_"+s+" img.expand_collapse_unit").each(function(){qqc.dataset_unit_expand_collapse(t,s,this)})},this.create_pay_screen=function(e,t,s,i,r){var a=qqc.$get_login_div(e,s),o=[];if(t[s].pay_errmsg)o.push("<strong>"+t[s].pay_errmsg+"</strong><br />");else{i&&o.push("<strong>"+i+"</strong><br />");var _=t[s].taker_payment_type_ids.length;t[s].any_promo;o.push('<form action="https://www.paypal.com/cgi-bin/webscr" onSubmit="return qwiz_qcards_common.submit_for_payment (\''+e+"', "+s+', this)" method="post" target="_blank">'),o.push('<input type="hidden" name="cmd" value="_s-xclick">'),"qwiz_"==e&&qwiz_.get_qwizdata(s,"display_pay_screen")?o.push('<input type="hidden" name="hosted_button_id" value="WH6FWJY29SWN8">'):o.push('<input type="hidden" name="hosted_button_id" value="GK23Z877AZC68">'),o.push('<table class="pay_options">'),o.push("<tr>"),o.push("<td>"),o.push('<input type="hidden" name="on0" value="Options">'),_>1&&o.push("Please choose:"),o.push("</td>"),o.push("</tr>"),o.push("<tr>"),o.push("<td>");var n="";2==_&&(n=' size="2" style="min-height: 40px;"'),o.push('<select name="os0"'+n+" onchange=\"qwiz_qcards_common.update_pay_button (this, '"+e+"', "+s+')">');for(var c=!0,d=!1,l=0;l<_;l++){var u,p=t[s].taker_fees[l],h=t[s].taker_good_for_n_periodss[l],g=t[s].taker_good_for_periods[l],q=t[s].taker_payment_descriptions[l],m=t[s].taker_payment_selected_bs[l];p<=0?(u=qqc.capitalize(qqc.number_to_word(h))+" "+qqc.Tplural(g,g+"s",h),0==l&&(m=!0,d=!0)):(u=qqc.currency(p)+" "+qqc.number_to_word(h)+" "+qqc.Tplural(g,g+"s",h),r&&"Pay now"==r&&(d||(m=!0,d=!0))),q&&(u+=" - "+(q=(q=q.replace(/<\/{0,1}b>/gi,"")).replace(/<[^>]+>.*/,"")));var w=m?" selected":"";o.push('<option value="'+p+'"'+w+">"),o.push(u),o.push("</option>"),p>0&&(c=!1)}o.push("</select> "),o.push("</td>"),o.push("</tr>"),o.push("</table>"),o.push('<input type="hidden" name="currency_code" value="USD">'),c||t[s].taker_fees[0]<=0&&(!r||"Sign up"==r)?(sign_up_display="block",paypal_display="none"):(sign_up_display="none",paypal_display="block");var f='style="display: '+sign_up_display+';"';o.push('<div class="sign_up_button" '+f+">"),o.push('<input type="submit" class="qwiz_button" value="Sign up" />'),o.push('<div class="signup_confirm_email_errmsg qwiz_errmsg" style="display: none;">'),o.push("</div>"),o.push("</div>"),f='style="display: '+paypal_display+';"',o.push('<div class="paypal_button" '+f+">"),o.push('<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" style="border: none;" name="submit" alt="PayPal - The safer, easier way to pay online!">'),o.push('   <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">'),o.push("</div>"),o.push('<input type="hidden" name="custom">'),o.push("</form>"),o.push("<button onclick=\"qwiz_qcards_common.payment_received (1, '"+e+"', "+s+')" class="qwiz_pay_cancel qwiz-smaller">'),o.push("Cancel"),o.push("</button>")}a.html(o.join("\n")).show()},this.update_pay_button=function(e,t,s){var i=qwiz_deck_selector(t,s);$(i+" div.signup_confirm_email_errmsg").hide(),e.value<="0.00"?($(i+"div.sign_up_button").show(),$(i+"div.paypal_button").hide()):($(i+"div.sign_up_button").hide(),$(i+"div.paypal_button").show())},this.hide_signup_confirm_email_errmsg=function(e){$(e).parents("div.sign_up_button").find("div.signup_confirm_email_errmsg").hide()},this.update_email_callback=function(e,t,s){debug&&console.log("[update_email_callback] qname:",e,", i_qwiz:",t,", errmsg:",s);var i=qwiz_deck_selector(e,t);if("need_password"==s)return qqc.create_password_dialog(e,t),$dialog_current_password.dialog("open"),!1;"password_incorrect"==s?$("#current_password_errmsg").html("Password incorrect"):"not_unique"==s?($(i+" div.update_email_errmsg").html("Email address already in use"),$(i+" span.confirm_email_address").addClass("qwiz_button_disabled")):"fail"==s?$(i+" div.update_email_errmsg").html("Sorry, unable to update email"):"ok"==s&&(document_qwiz_email=$(i+" input.confirm_email_address").val(),qqc.confirm_email2(e,t)),$dialog_current_password&&$dialog_current_password.dialog("close")},this.update_email_hide_error=function(e,t){var s=qwiz_deck_selector(e,t);return $(s+" div.update_email_errmsg").html(""),$(s+" span.confirm_email_address").removeClass("qwiz_button_disabled"),!1},this.confirm_email=function(e,t,s){if($(e).hasClass("qwiz_button_disabled"))return!1;var i=qwiz_deck_selector(t,s),r=$(i+"input.confirm_email_address").val();if(""==r)return $(i+" div.update_email_errmsg").html("Please enter email address"),$(e).addClass("qwiz_button_disabled"),!1;if(r!=document_qwiz_email){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(r)?(update_email_data={field:"email",value:r,callback:"qwiz_qcards_common.update_email_callback"},$(i+" span.confirm_email_address").addClass("qwiz_button_disabled"),qqc.qjax(t,s,"","update_my_account",update_email_data)):($(i+" div.update_email_errmsg").html("Not a valid email address"),$(e).addClass("qwiz_button_disabled")),!1}qqc.confirm_email2(t,s)},this.confirm_email2=function(e,t){var s=qwiz_deck_selector(e,t);$(s+" .signup_confirm_email").css({visibility:"visible"}),$(s+" input.signup_confirm_email").val("").focus(),$(s+" input.sign_up").removeClass("qwiz_button_disabled").removeAttr("disabled"),$(s+" div.signup_confirm_email_errmsg").hide();var i={field:"email_confirm",value:"",email_address:$(s+" input.confirm_email_address").val(),username:document_qwiz_username,callback:"qwiz_qcards_common.confirm_email_callback"};qqc.qjax(e,t,"","update_my_account",i)},this.confirm_email_callback=function(e,t,s){debug[0]&&console.log("[confirm_email_callback] errmsg:",s),"need_password"==s&&(qqc.create_password_dialog(e,t),$dialog_current_password.dialog("open"))},this.hide_current_password_errmsg=function(){$("#current_password_errmsg").html("")},this.create_password_dialog=function(e,t){var s=[];s.push('<div id="dialog_current_password" title="Security check: re-enter password">'),s.push("<tr>"),s.push("<td>"),s.push("Password"),s.push("</td>"),s.push("<td>"),s.push('<input id="current_password" type="password" onfocus="qwiz_qcards_common.hide_current_password_errmsg ()" />'),s.push("<br />"),s.push('<div id="current_password_errmsg" class="qwiz_errmsg">'),s.push("</div>"),s.push("</td>"),s.push("</tr>"),s.push("</div>"),$("body").append(s.join("\n")),$dialog_current_password=$("#dialog_current_password").dialog({autoOpen:!1,height:200,width:350,modal:!0,buttons:{Submit:function(){qqc.update_session_id(e,t)},Cancel:function(){$dialog_current_password.dialog("close")}}})},this.update_session_id=function(e,t){var s=$("#current_password").val();""!=s?(update_email_data.sha3_current_password=CryptoJS.SHA3(s).toString(),update_email_data.current_username=document_qwiz_username,qqc.qjax(e,t,"","update_my_account",update_email_data)):$("#current_password_errmsg").html("Please enter password")},this.create_enroll_screen=function(e,t){var s=[];s.push('<p style="font-weight: normal; text-align: left; margin: 0 0 0 10px;">'),s.push("You are currently registered as an &ldquo;independent student,&rdquo; not enrolled in a school or class.&nbsp;"),s.push("If you have a registration code you can join a class.&nbsp;"),s.push("<br />(Any work you have completed on quizzes and flashcard decks will be transferred to the teacher&rsquo;s gradebook.)"),s.push("</p>"),s.push('<table class="qwiz-border-none qwiz-padding" border="0" align="center"'),s.push("<tr>"),s.push('<td colspan="2">'),s.push('<span class="qwiz-normal"><i>If your teacher gave you a registration code please enter it here</i></span>'),s.push("</td>"),s.push("</tr>"),s.push("<tr>"),s.push('<td style="vertical-align: top;">'),s.push("<b>Registration code</b>"),s.push("</td>"),s.push("<td>"),s.push('<input type="text" class="enroll_screen_reg_code" style="padding: 2px;" onfocus="qwiz_qcards_common.hide_enroll_error ()" onkeydown="qwiz_qcards_common.enroll_registration_code_keydown (\''+e+"', "+t+');" />'),s.push('<div class="enroll_screen_reg_code_errmsg qwiz_errmsg"></div>'),s.push('<div class="enroll_screen_reg_code_class_name"></div>'),s.push("</td>"),s.push("</tr>"),s.push("<tr>"),s.push("<td>"),s.push("</td>"),s.push("<td>"),s.push('<button class="enroll_check_reg_code qwiz_button" onclick="qwiz_qcards_common.check_reg_code (\''+e+"', "+t+')">'),s.push("Check code"),s.push("</button>"),s.push('<button class="enroll_join_class qwiz_button" style="display: none;" onclick="qwiz_qcards_common.reset_independent_student (\''+e+"', "+t+')">'),s.push("Join class"),s.push("</button>"),plugin_url||(plugin_url=qqc.get_qwiz_param("url","./")),s.push('<img class="enroll_spinner" style="display: none;" src="'+plugin_url+'images/spinner16x16.gif" />'),s.push("</td>"),s.push("</tr>"),s.push("</table>"),s.push('<div style="text-align: right; padding-right: 10px;">'),s.push('<button class="qwiz-smaller" onclick="'+e+".no_login ("+t+', false, true)">'),s.push("Cancel"),s.push("</button>"),s.push("</div>"),qqc.$get_login_div(e,t).html(s.join("\n")).show()},this.check_reg_code=function(e,t){var s=qwiz_deck_selector(e,t),i=$(s+"input.enroll_screen_reg_code").val();if(""!=i){$(".enroll_spinner").show();var r={reg_code:i,js_f:1};qqc.qjax(e,t,"","check_reg_code",r)}return!1},this.reg_code_ok_or_no=function(e){debug[0]&&console.log("[reg_code_ok_or_no] data:",e);var t=qwiz_deck_selector(e.qname,e.i_qwiz);$(t+".enroll_spinner").hide(),(enroll_reg_code_ok_f=1==e.num_rows)?(enroll_reg_code_school_id=e.school_id,enroll_reg_code_school_name=e.school_name,enroll_reg_code_class_id=e.class_id,enroll_reg_code_class_name=e.class_name,$(t+"div.enroll_screen_reg_code_class_name").html("<b>Registration for class "+e.class_name+", "+e.school_name+"</b>").show(),$(t+"button.enroll_check_reg_code").hide(),$(t+"button.enroll_join_class").show()):($(t+"div.enroll_screen_reg_code_errmsg").html("Could not find registration code").show(),$(t+"div.enroll_screen_reg_code_class_name").html("").hide())},this.hide_enroll_error=function(){$("div.enroll_screen_reg_code_errmsg").html("").hide()},this.enroll_registration_code_keydown=function(e,t){debug[0]&&console.log("[enroll_registration_code_keydown] enroll_reg_code_ok_f:",enroll_reg_code_ok_f);var s=qwiz_deck_selector(e,t);enroll_reg_code_ok_f?($(s+"button.enroll_join_class").hide(),$(s+"button.enroll_check_reg_code").show()):($(s+"div.enroll_screen_reg_code_errmsg").html("").hide(),$(s+"div.enroll_screen_reg_code_class_name").html("").hide())},this.reset_independent_student=function(e,t){debug[0]&&console.log("[reset_independent_student]");var s=qwiz_deck_selector(e,t);if(""==$(s+"input.enroll_screen_reg_code").val())return $("div.enroll_screen_reg_code_errmsg").html("Please enter registration code").show(),!1;$(s+".enroll_spinner").show();var i={jjax:1,school_id:enroll_reg_code_school_id,class_id:enroll_reg_code_class_id,taker_id:document_qwiz_taker_id};return qqc.qjax(e,t,"","reset_independent_student",i),!1},this.reset_independent_student_callback=function(e){if(debug[0]&&console.log("[reset_independent_student_callback] data:",e),"ok"==e.errmsg)e.jjax=1,qqc.qjax(e.qname,e.i_qwiz,"","add_to_class",e);else{var t=[];t.push("<br /><p><b>Sorry, unable to reset status</b></p>"),t.push('<button class="qwiz_button" onclick="'+e.qname+".no_login ("+e.i_qwiz+', false, true, event)">'),t.push("Continue"),t.push("</button>"),t=t.join("\n"),qqc.$get_login_div(e.qname,e.i_qwiz).html(t).show()}},this.add_to_class_callback=function(e){debug[0]&&console.log("[add_to_class_callback] data:",e);var t=qwiz_deck_selector(e.qname,e.i_qwiz);$(t+".enroll_spinner").hide();var s=[];"ok"==e.errmsg?(document_qwiz_school_id=enroll_reg_code_school_id,document_qwiz_class_id=enroll_reg_code_class_id,document_qwiz_independent_taker_f=!1,qqc.set_user_menus_and_icons(),s.push("<br /><p><b>You are now enrolled in "+enroll_reg_code_class_name+", "+enroll_reg_code_school_name+"</b></p>")):s.push("<br /><p><b>Sorry, unable to reset status</b></p>"),s.push('<button class="qwiz_button" onclick="'+e.qname+".no_login ("+e.i_qwiz+', false, true, event)">'),s.push("Continue"),s.push("</button>"),s=s.join("\n"),qqc.$get_login_div(e.qname,e.i_qwiz).html(s).show()},this.create_provide_feedback_screen=function(e,t,s){var i,r,a=[];if(a.push('<div style="margin-top: 5px">'),a.push("<b>Feedback - bugs, errors, suggestions...?</b>"),a.push("</div>"),a.push('<div class="qwiz-normal qwiz-smaller">'),a.push("Feel free to copy and paste, including screenshots!"),a.push("</div>"),"qcard_"==e){var o=$("div.qcard_card-qdeck"+t),_=o.width()-16,n=.62*o.height();i=' style="width: '+parseInt(_)+"px; height: "+parseInt(n)+'px;"',r="div.qcard_card-qdeck"+t}else i=' style="min-height: 175px;"',r="div#qwiz"+t;a.push('<div class="qwiz-provide_feedback"'+i+' contenteditable="true">'),provide_feedback_html[r]&&a.push(provide_feedback_html[r]),a.push("</div>"),a.push('<div class="qwiz-normal qwiz-smaller" style="text-align: left;">'),a.push("From: "+document_qwiz_username),a.push("</div>"),a.push("<div>"),a.push('<button class="qwiz_button" onclick="qwiz_qcards_common.submit_feedback (\''+e+"', "+t+", "+s+')">'),a.push("Submit"),a.push("</button>"),a.push("&emsp;"),a.push('<button class="qwiz_button_small qwiz-b_and_w" onclick="qwiz_qcards_common.cancel_provide_feedback (\''+e+"', "+t+')">'),a.push("Back"),a.push("</button>"),a.push('<span class="qwiz-smaller qwiz-normal">'),a.push("(you can return to complete your comments)"),a.push("</span>"),a.push("</div>"),qqc.$get_login_div(e,t).html(a.join("\n")).show();$("div.qwiz-provide_feedback").on("paste",function(e){var t=this;setTimeout(function(){resize_feedback_images(t)},100)})},this.submit_feedback=function(e,t,s){var i=$(("qwiz_"==e?"div#qwiz"+t:"div.qcard_card-qdeck"+t)+" div.qwiz-provide_feedback").html();if(-1!=i.indexOf("<img")){var r=i.match(/<img src="blob:[^"]+/g);if(r){global_blob_urls=[],global_data_urls=[];for(var a=r.length,o=0;o<a;o++){r[o].length;global_blob_urls.push(r[o].substr(10))}get_blobs_as_data_urls(e,t,s,a,i,r)}else submit_feedback2(e,t,s,i)}else{if(qqc.is_only_tags_and_whitespace(i))return!1;submit_feedback2(e,t,s,i)}},this.is_only_tags_and_whitespace=function(e){return-1==(e=(e=qqc.remove_tags_eols(e,!0)).replace(/&nbsp;|&ensp;|&emsp;|&thinsp;|&hairsp;/,"")).search(/\S/)},this.submit_feedback_callback=function(e,t,s,i,r){var a=[];a.push("<p>"),a.push("<b>"+r+"</b>"),a.push("</p>"),i?(provide_feedback_html[s]="",a.push('<button class="qwiz_button" onclick="'+e+".no_login ("+t+', false, true)">'),a.push("Continue"),a.push("</button>")):(a.push('<button class="qwiz-smaller" onclick="'+e+".no_login ("+t+', false, true)">'),a.push("Back"),a.push("</button>")),qqc.$get_login_div(e,t).html(a.join("\n")).show()},this.cancel_provide_feedback=function(e,t){var s,i=$((s="qwiz_"==e?"div#qwiz"+t:"div.qcard_card-qdeck"+t)+" div.qwiz-provide_feedback");provide_feedback_html[s]=i.html(),provide_feedback_html[s].length>2e7&&alert("Please note: the images in your feedback are large. You may want to submit your comments so far before adding more images."),("qwiz_"==e?qwiz_:qcard_).no_login(t,!1,!0)},this.preview_iframe_close=function(){$("div#preview_iframe_wrapper").remove()},this.init_hide_show_password=function(e){$(e).hidePassword(!0,{states:{shown:{toggle:{className:"qwiz-hideShowPassword-toggle-hide"}},hidden:{toggle:{className:"qwiz-hideShowPassword-toggle-show"}}}})},this.create_register_taker_screen=function(e,t,s){register_taker_global_reg_code_ok_f=!1,register_taker_global_username="",register_taker_global_first_name="",register_taker_global_last_name="",register_taker_global_sha3_password="",register_taker_global_username_unique_f=!1,register_taker_global_email_unique_f=!1;var i=[];i.push('<form name="register_taker_'+e+t+'" action="nada.php" onSubmit="return qwiz_qcards_common.register_taker (\''+e+"',"+t+", "+s+')">'),i.push('<table class="register_taker">'),i.push("<tr>"),i.push("<td>"),i.push("</td>"),i.push('<td colspan="2" class="register_taker_if_your_teacher" style="white-space: nowrap; font-weight: normal;">'),i.push("<i>If your teacher gave you a registration code"),i.push("please enter it here</i>"),i.push("</td>"),i.push("</tr>"),i.push("<tr>"),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="reg_code">'),i.push("Registration code"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="text" class="register_taker_reg_code" onchange="qwiz_qcards_common.register_taker_check_reg_code (\''+e+"', "+t+', this.value)" onfocus="qwiz_qcards_common.register_taker_hide_error (\''+e+"', "+t+', this);" />'),i.push('<div class="register_taker_reg_code_errmsg qwiz_errmsg"></div>'),i.push('<div class="register_taker_reg_code_class_name"></div>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_please_continue_below">'),i.push("<td>"),i.push("</td>"),i.push('<td colspan="2" style="font-weight: normal;">'),i.push("<i>All students: enter your name and password"),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_login_name_exists">'),i.push("<td>"),i.push("</td>"),i.push('<td colspan="2">'),i.push("<i>This login name exists."),i.push("Either log in or choose another name.</i>"),i.push("</td>"),i.push("</tr>"),i.push("<tr>"),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="username">'),i.push("Login name"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="text" class="register_taker_username" onchange="qwiz_qcards_common.register_taker_check_unique (\''+e+"', "+t+", 'username')\" onblur=\"qwiz_qcards_common.register_taker_check_unique ('"+e+"', "+t+", 'username')\" onfocus=\"qwiz_qcards_common.register_taker_hide_error ('"+e+"', "+t+', this);" /> <span class="qwiz-required">*</span>'),i.push('<div class="register_taker_username_errmsg qwiz_errmsg"></div>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_first_name_last_name">'),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="first_name">'),i.push("First name"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="text" class="register_taker_first_name" onfocus="qwiz_qcards_common.register_taker_hide_error (\''+e+"', "+t+', this);" /> <span class="qwiz-required">*</span>'),i.push('<div class="register_taker_first_name_errmsg qwiz_errmsg"></div>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_first_name_last_name">'),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="last_name">'),i.push("Last name"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="text" class="register_taker_last_name" onfocus="qwiz_qcards_common.register_taker_hide_error (\''+e+"', "+t+', this);" /> <span class="qwiz-required">*</span>'),i.push('<div class="register_taker_last_name_errmsg qwiz_errmsg"></div>'),i.push("</td>"),i.push("</tr>"),i.push("<tr>"),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="password">'),i.push("Password"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="password" class="register_taker_password" onchange="qwiz_qcards_common.register_taker_check_password_match (\''+e+"', "+t+')" onfocus="qwiz_qcards_common.register_taker_hide_error (\''+e+"', "+t+', this);" /> <span class="qwiz-required">*</span>'),i.push('<div class="register_taker_password_errmsg register_taker_confirm_password_errmsg qwiz_errmsg"></div>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_confirm_password_email">'),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="confirm_password">'),i.push("Confirm&nbsp;password"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="password" class="register_taker_confirm_password" onchange="qwiz_qcards_common.register_taker_check_password_match (\''+e+"', "+t+')" onfocus="qwiz_qcards_common.register_taker_hide_error (\''+e+"', "+t+', this);" /> <span class="qwiz-required">*</span>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_email register_taker_confirm_password_email">'),i.push("<td>"),i.push("</td>"),i.push("<td>"),i.push('<label for="email">'),plugin_url||(plugin_url=qqc.get_qwiz_param("url","./")),i.push("Email"),i.push("</label>"),i.push("</td>"),i.push("<td>"),i.push('<input type="text" class="register_taker_email" onchange="qwiz_qcards_common.register_taker_validate_email (\''+e+"', "+t+", '', true)\" onfocus=\"qwiz_qcards_common.register_taker_hide_error ('"+e+"', "+t+', this);" /> <span class="qwiz-required register_taker_email_required">*</span>'),i.push('<div class="register_taker_email_errmsg qwiz_errmsg"></div>'),i.push("</td>"),i.push("</tr>"),i.push('<tr class="register_taker_email register_taker_confirm_password_email">'),i.push("<td>"),i.push("</td>"),i.push('<td colspan="2" style="line-height: 1;">'),i.push('<span class="qwiz-smaller qwiz-normal">'),i.push("Your email address is required since you haven&rsquo;t entered a registration code for a class.&nbsp;"),i.push("Your email is used only if you click &ldquo;Forgot password&rdquo;."),i.push("</span>"),i.push("</td>"),i.push("</tr>"),i.push("</tr>"),i.push('<td colspan="2">');var r="";"qwiz_"==e&&(r=qwiz_.get_qwizdata(t,"display_pay_screen")),i.push("</td>"),i.push("<td>"),i.push('<span style="float: right;">'),i.push('<span class="qwiz_button" style="font-size: 9pt !important;" onclick="'+e+".no_login ("+t+', false, true, event)">'),i.push("Cancel"),i.push("</span>"),i.push("&emsp;"),i.push('<span class="qwiz-required ">*</span>'),i.push('<span class="qwiz-smaller">required</span>'),i.push("</span>"),i.push('<button type="submit" class="qwiz_button">'),i.push('<span class="register_taker_login" style="font-size: 12pt !important;">'),i.push("Register"),i.push("</span>"),i.push("</button>"),i.push("<br />"),i.push('<span class="register_taker_forgot_password">'),"not ready"==server_loc&&(secure_server_loc=qqc.get_qwiz_param("secure_server_loc","https://host359.hostmonster.com/~whereisq/qwiz/admin")),i.push('<a href="'+secure_server_loc+'/password_reset_request" target="_blank">'),i.push("Forgot password?</a>"),i.push("</span>"),i.push("</td>"),i.push("</tr>"),i.push("<tr>"),i.push("<td>"),i.push("</td>"),i.push('<td colspan="2" class="register_taker_errmsg qwiz_errmsg">'),i.push("</td>"),i.push("</tr>"),i.push("</table>"),i.push("</form>"),qqc.$get_login_div(e,t).html(i.join("\n")).show();var a=qwiz_deck_selector(e,t);qqc.init_hide_show_password(a+".register_taker_password"),qqc.init_hide_show_password(a+".register_taker_confirm_password"),"register"!=r&&$(a+".register_taker_reg_code").val("").focus()},this.register_taker_check_password_match=function(e,t){var s=qwiz_deck_selector(e,t);$(s+".register_taker_password_errmsg").hide();var i=$(s+".register_taker_confirm_password").val();if(""!=i){var r=$(s+".register_taker_password").val();""!=r&&r!=i&&$(s+".register_taker_password_errmsg").html("Password and Confirm password do not match").show()}},this.register_taker_check_reg_code=function(e,t,s){if(""==s){var i=qwiz_deck_selector(e,t);$(i+"tr.register_taker_first_name_last_name").show(),$(i+".register_taker_reg_code_class_name").html("").hide(),$(i+".register_taker_login_name_exists,"+i+"  .register_taker_forgot_password").hide(),$(i+"span.register_taker_login").html("Register"),$(i+"tr.register_taker_confirm_password_email").show(),$(i+"tr.register_taker_please_continue_below").show(),$(i+".register_taker_email_required, "+i+".register_taker_email").show(),register_taker_global_reg_code_ok_f=!1,qqc.register_taker_check_unique(e,t,"username")}else{var r={reg_code:s,callback:"register_taker_reg_code_ok_or_no"};register_taker_global_in_process_b=!0,qqc.qjax(e,t,"","check_reg_code",r)}return!1},this.register_taker_reg_code_ok_or_no=function(e){debug[0]&&console.log("[register_taker_reg_code_ok_or_no] data:",e),register_taker_global_reg_code_ok_f=1==e.num_rows;var t=qwiz_deck_selector(e.qname,e.i_qwiz);register_taker_global_reg_code_ok_f?($(t+".register_taker_if_your_teacher").hide(),$(t+"tr.register_taker_please_continue_below").hide(),$(t+"tr.register_taker_first_name_last_name").show(),$(t+".register_taker_email_required, "+t+".register_taker_email").hide(),register_taker_global_reg_code_maker_id=e.maker_id,register_taker_global_reg_code_school_id=e.school_id,register_taker_global_reg_code_class_id=e.class_id,register_taker_global_reg_code_class_name=e.class_name,register_taker_global_reg_code_school_name=e.school_name,$(t+".register_taker_reg_code_class_name").html("<b>Registration for class "+register_taker_global_reg_code_class_name+", "+register_taker_global_reg_code_school_name+"</b>").show()):($(t+".register_taker_reg_code_errmsg").html("Could not find registration code").show(),$(t+".register_taker_reg_code_class_name").html("").hide()),register_taker_global_in_process_b=!1},this.register_taker_check_unique=function(e,t,s){var i=qwiz_deck_selector(e,t),r=$(i+".register_taker_"+s).val();if(""!=r){var a={field:s,value:r,callback:"register_taker_unique_or_no"};register_taker_global_in_process_b=!0,qqc.qjax(e,t,"","check_taker_name_email_unique",a)}return!1},this.register_taker_unique_or_no=function(e){debug[0]&&console.log("[register_taker_unique_or_no] data:",e);var t=qwiz_deck_selector(e.qname,e.i_qwiz),s=e.field,i=e.unique_f;"username"==s?(register_taker_global_username_unique_f=i,0==i?(debug[0]&&console.log('[register_taker_unique_or_no] "username already in use"'),register_taker_display_pay_screen_f="qwiz_"==e.qname&&qwiz_.get_qwizdata(e.i_qwiz,"display_pay_screen"),register_taker_global_reg_code_ok_f||register_taker_display_pay_screen_f?($(t+"tr.register_taker_confirm_password_email, "+t+"tr.register_taker_first_name_last_name").hide(),$(t+".register_taker_login_name_exists, "+t+".register_taker_forgot_password").show(),$(t+"span.register_taker_login").html("Log in"),$(t+".register_taker_password").focus()):($(t+".register_taker_username_errmsg").html("Login name already in use").show(),$(t+".register_taker_login_name_exists, "+t+".register_taker_forgot_password").hide(),$(t+"span.register_taker_login").html("Register"),$(t+"tr.register_taker_confirm_password_email").show())):($(t+"span.register_taker_login").html("Register"),$(t+"tr.register_taker_first_name_last_name").show(),$(t+".register_taker_login_name_exists, "+t+".register_taker_forgot_password").hide(),$(t+".register_taker_first_name").focus())):(register_taker_global_email_unique_f=i,0==i&&(debug[0]&&console.log('[register_taker_unique_or_no] "email already in use"'),$(t+".register_taker_email_errmsg").html("Email already in use").show())),register_taker_global_in_process_b=!1},this.register_taker=function(e,t,s){debug[0]&&console.log("[register_taker] register_taker_global_in_process_b:",register_taker_global_in_process_b);var i=0,r=function(){if(register_taker_global_in_process_b){if(debug[0]&&console.log("[delay_register_taker] n_tries:",i),i>40)return alert("Sorry, unable to process request"),!1;i++,setTimeout(r,250)}else qqc.register_taker2(e,t,s)};return setTimeout(r,250),!1},this.register_taker2=function(e,t,s){debug[0]&&console.log("[register_taker2]");var i=!0,r=qwiz_deck_selector(e,t),a=$(r+".register_taker_reg_code").val();""==(register_taker_global_username=$(r+".register_taker_username").val())&&($(r+".register_taker_username_errmsg").html("Please enter login name").show(),i=!1);var o=$(r+".register_taker_password").val();""==o&&($(r+".register_taker_password_errmsg").html("Please enter password").show(),i=!1);var _=$(r+"input.register_taker_email").val();if(!register_taker_global_reg_code_ok_f&&!register_taker_display_pay_screen_f||1==register_taker_global_username_unique_f||""==register_taker_global_username){if(i=i&&register_taker_global_username_unique_f,""==register_taker_global_username||register_taker_global_username_unique_f||($(r+".register_taker_username_errmsg").html("Login name already in use").show(),i=!1),""==(register_taker_global_first_name=$(r+".register_taker_first_name").val())&&($(r+".register_taker_first_name_errmsg").html("Please enter first name").show(),i=!1),""==(register_taker_global_last_name=$(r+".register_taker_last_name").val())&&($(r+".register_taker_last_name_errmsg").html("Please enter last name").show(),i=!1),""==a||register_taker_global_reg_code_ok_f||register_taker_display_pay_screen_f||(i=!1,$(r+".register_taker_reg_code_errmsg").html("Could not find registration code").show()),""==_?register_taker_global_reg_code_ok_f||($(r+".register_taker_email_errmsg").html("Please enter email").show(),i=!1):register_taker_global_email_unique_f?i=qqc.register_taker_validate_email(e,t,i):$(r+".register_taker_email_errmsg").html("Email already in use").show(),""!=o)o!=$(r+".register_taker_confirm_password").val()&&($(r+".register_taker_password_errmsg").html("Password and Confirm password do not match").show(),i=!1);""==a&&(s||(s="qwiz_"==e?qwiz_.get_qwizdata(t,"any_taker_options_free_b"):qcard_.get_deckdata(t,"any_taker_options_free_b"))),i?""==a&&(i=confirm('You have not entered a registration code;\nyou will be an "independent student," not in a class.\n\nIs this OK?  If not, click "Cancel" and enter a code.')):"qcard_"==e&&qcard_.set_container_width_height(t)}if(register_taker_global_sha3_password=CryptoJS.SHA3(o).toString(),i){var n={login_f:(register_taker_global_reg_code_ok_f||register_taker_display_pay_screen_f)&&0==register_taker_global_username_unique_f?1:0,reg_code:a,school_id:register_taker_global_reg_code_school_id,username:register_taker_global_username,firstname:register_taker_global_first_name,lastname:register_taker_global_last_name,sha3_password:register_taker_global_sha3_password,email:_,register_v2:"1",callback:"taker_registered"};s&&(n.proceed_to_pay_f="1"),debug[0]&&console.log("[register_taker2] data",n),qqc.qjax(e,t,"","new_student_registration",n)}return!1},this.register_taker_hide_error=function(e,t,s){var i=s.className,r=qwiz_deck_selector(e,t);$(r+"."+i+"_errmsg").hide(),$(r+".register_taker_errmsg").hide()},this.taker_registered=function(e){debug[0]&&(console.log("[taker_registered] data:",e),console.log("[taker_registered] register_taker_global_reg_code_ok_f:",register_taker_global_reg_code_ok_f,", register_taker_global_username_unique_f:",register_taker_global_username_unique_f),console.log("[taker_registered] register_taker_display_pay_screen_f:",register_taker_display_pay_screen_f));var t=e.errmsg,s="";if(t)s="login unsuccessful"==t?"Incorrect username/password.":"duplicate username"==t?"Login name is already in database.":"Unable to create account";else{document_qwiz_user_logged_in_b=!0,document_qwiz_session_id=e.session_id,document_qwiz_username=register_taker_global_username,document_qwiz_school_id=e.school_id,document_qwiz_independent_taker_f=1==e.school_id,document_qwiz_email=e.email;if($.cookie("qwiz_session_id",document_qwiz_session_id,{path:"/",expires:1}),document_qwiz_remember_f=!0,qqc.set_user_menus_and_icons(),qwiz_&&qwiz_.any_pay_quiz_f&&qwiz_.pay_lock_settings(),qcard_&&qcard_.any_pay_deck_f&&qcard_.pay_lock_settings(),register_taker_global_reg_code_ok_f){e.login_f&&(register_taker_global_first_name=e.firstname,register_taker_global_last_name=e.lastname);var i={};i.First_name=[register_taker_global_first_name],i.Last_name=[register_taker_global_last_name];var r={userids:[register_taker_global_username],usernames:[register_taker_global_username],passwords:[register_taker_global_sha3_password],custom_input_data:{input_field_names:["First_name","Last_name"],fields:i}};qqc.input_data_to_db(e.qname,e.i_qwiz,register_taker_global_reg_code_maker_id,register_taker_global_reg_code_school_id,register_taker_global_reg_code_class_id,register_taker_global_reg_code_class_name,r)}else register_taker_registered_feedback(e.qname,e.i_qwiz,!0,e.proceed_to_pay_f)}if(s){var a=qwiz_deck_selector(e.qname,e.i_qwiz);$(a+".register_taker_errmsg").html(s).show()}return!1},this.register_taker_validate_email=function(e,t,s,i){var r=qwiz_deck_selector(e,t),a=$(r+"input.register_taker_email").val();if(""!=a){/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(a)?i&&qqc.register_taker_check_unique(e,t,"email"):($(r+".register_taker_email_errmsg").html("Not a valid email address").show(),s=!1)}return s},this.input_data_to_db=function(e,t,s,i,r,a,o){debug[0]&&console.log("[input_data_to_db] taker_data:",o);var _={};_.qname=e,_.i_qwiz=t,_.class_id=r,_.class_name=a,_.school_id=i,_.maker_id=s,_.taker_data=o,_.callback="register_taker_input_data_to_db_callback",debug[0]&&console.log("[input_data_to_db] data:",_),qwiz_qcards_common.qjax(e,t,"","new_class",_)},this.register_taker_input_data_to_db_callback=function(e){debug[0]&&console.log("[input_data_to_db_callback] data:",e),e.error_f?alert("Sorry, registration did not work"):register_taker_registered_feedback(e.qname,e.i_qwiz,!1)},this.check_promo_code=function(e,t){var s=$("#"+e+"promo_code"+t+" input").val();if(""!=s){var i={qname:e,promo_code:s,pay_quiz_deck_id:get_qwizdeckdata(e,t,"pay_quiz_deck_id")};qqc.qjax(e,t,"","check_promo_code",i)}return!1},this.check_promo_code2=function(e){debug[0]&&console.log("[check_promo_code2] data:",e);var t=e.qname,s=e.i_qwiz,i=$("p#"+t+"promo_code"+s);e.errmsg?(i.find("span.promo_code_errmsg").html("<br />"+e.errmsg),i.find("span.promo_code_okmsg").html("")):(qqc.set_qwizdeckdata(t,s,"promo_code",e.promo_code),"qwiz_"==t?qwiz_.pay_lock_settings(s,s):qcard_.pay_lock_settings(s,s))},this.clear_promo_code_msgs=function(e,t){$("p#"+e+"promo_code"+t+" span.promo_code_msg").html("")},this.submit_for_payment=function(e,t,s){debug[0]&&console.log("[submit_for_payment] qname:",e,", i_qwiz:",t,", form_el:",s);var i=get_qwizdeckdata(e,t,"pay_quiz_deck_id"),r=s.os0.selectedIndex;if(-1==r){var a=qwiz_deck_selector(e,t);return $(a+" div.signup_confirm_email_errmsg").html("Please choose a payment option").show(),!1}if(!document_qwiz_session_id){a=qwiz_deck_selector(e,t);return $(a+" div.signup_confirm_email_errmsg").html("Sorry, login session not set. Please refresh this page in your browser and try again, or contact support@qwizcards.com").show(),!1}var o=get_qwizdeckdata(e,t,"taker_payment_type_ids")[r],_=s.os0.value;if(parseFloat(_)>=9&&(s.hosted_button_id.value="WH6FWJY29SWN8"),pay_qwiz_qdeck_=e,pay_i_qwiz_deck=t,_<=0){var n={url:qqc.get_qwiz_param("url","./"),payment_type_id:o,qwiz_session_id:document_qwiz_session_id};"qwiz_"==e&&qwiz_.get_qwizdata(t,"display_pay_screen")&&(n.no_alert=1);a=qwiz_deck_selector(e,t);var c=$(a+" input.signup_confirm_email").val();return c||(c=0),n.confirm_email_code=c,qqc.qjax(e,t,"","payment_zero",n),!1}var d={m:0,pid:i,ptid:o,sid:document_qwiz_session_id,url:qqc.get_qwiz_param("url","./")};return debug[0]&&console.log("[submit_for_payment] custom_data:",d),s.custom.value=btoa(JSON.stringify(d)),!0},this.create_maker_pay_screen=function(e,t,s,i){var r=qqc.$get_login_div(e,s),a=[];if(t[s].pay_errmsg)a.push("<strong>"+t[s].pay_errmsg+"</strong><br />");else{i&&a.push("<strong>"+i+"</strong><br />");var o=t[s].maker_payment_type_ids.length;a.push('<form action="https://www.paypal.com/cgi-bin/webscr" onSubmit="return qwiz_qcards_common.submit_for_payment (\''+e+"', "+s+', this)" method="post" target="_blank">'),a.push('<input type="hidden" name="cmd" value="_s-xclick">'),a.push('<input type="hidden" name="hosted_button_id" value="GK23Z877AZC68">'),a.push('<table class="pay_options">'),a.push("<tr>"),a.push("<td>"),a.push('<input type="hidden" name="on0" value="Options">'),o>1&&a.push("Please choose:"),a.push("</td>"),a.push("</tr>"),a.push("<tr>"),a.push("<td>"),a.push('<select name="os0">');for(var _=0;_<o;_++){var n=t[s].maker_fees[_],c=t[s].maker_good_for_n_periodss[_],d=t[s].maker_good_for_periods[_],l=t[s].maker_payment_descriptions[_],u=qqc.currency(n)+" "+qqc.number_to_word(c)+" "+qqc.Tplural(d,d+"s",c);l&&(u+=" - "+l),a.push('<option value="'+n+'">'),a.push(u),a.push("</option>")}a.push("</select> "),a.push("</td>"),a.push("</tr>"),a.push("</table>"),a.push('<input type="hidden" name="currency_code" value="USD">'),a.push('<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" style="border: none;" name="submit" alt="PayPal - The safer, easier way to pay online!">'),a.push('<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">'),a.push('<input type="hidden" name="custom">'),a.push("</form>")}r.html(a.join("\n")).show()},this.submit_for_maker_payment=function(e,t,s){debug[0]&&console.log("[submit_for_maker_payment] qname:",e,", i_qwiz:",t,", form_el:",s);var i=get_qwizdeckdata(e,t,"pay_quiz_deck_id"),r=s.os0.selectedIndex,a={m:1,pid:i,ptid:get_qwizdeckdata(e,t,"maker_payment_type_ids")[r],sid:qqc.maker_session_id,url:qqc.get_qwiz_param("url","./")};return debug[0]&&console.log("[submit_for_maker_payment] custom_data:",a),s.custom.value=btoa(JSON.stringify(a)),pay_qwiz_qdeck_=e,pay_i_qwiz_deck=t,!0},this.payment_received=function(e,t,s,i){if(debug[0]&&console.log("[payment_received] no_set_f:",e,", confirm_email_errmsg:",i),i){var r=qwiz_deck_selector(t,s);return $(r+" div.signup_confirm_email_errmsg").html(i).show(),!1}(e?(pay_qwiz_qdeck_=t,pay_i_qwiz_deck=s):(document_qwiz_email_confirm=1,qwiz_&&qwiz_.any_pay_quiz_f&&("qwiz_"==t&&qwiz_.get_qwizdata(s,"display_pay_screen")&&(payment_received_f=!0),qwiz_.pay_lock_settings()),qcard_&&qcard_.any_pay_deck_f&&qcard_.pay_lock_settings()),"qwiz_"==pay_qwiz_qdeck_)?($("#qwiz_login-qwiz"+pay_i_qwiz_deck).hide(),-1==qwiz_.get_qwizdata(pay_i_qwiz_deck,"i_question")?($(".intro-qwiz"+pay_i_qwiz_deck).show(),qwiz_.position_show_next_button(pay_i_qwiz_deck)):qwiz_.login_ok_start_quiz(pay_i_qwiz_deck)):($("#qdeck_login-qdeck"+pay_i_qwiz_deck).hide(),qcard_.login_ok_start_deck(pay_i_qwiz_deck))},this.registration_complete=function(e,t,s,i){debug[0]&&console.log("[registration_complete] qname:",e,", i_qwiz:",t,", session_id:",s,", username:",i),document_qwiz_session_id=s,document_qwiz_username=i,document_qwiz_school_id=1,document_qwiz_independent_taker_f=1,("qwiz_"==e?qwiz_:qcard_).login_ok(t,s,0)},this.maker_login_registration_complete=function(e,t,s,i){debug[0]&&console.log("[maker_login_registration_complete] qname:",e,", i_qwiz:",t,", maker_session_id:",s,", username:",i),qqc.maker_session_id=s;$.cookie("maker_session_id",s,{path:"/",expires:1}),("qwiz_"==e?qwiz_:qcard_).hide_menu_and_display_login(t,!1,"maker_pay"),setTimeout(function(){alert("Admin registration/login successful")},250)},this.set_login_expiry=function(){debug[0]&&console.log("[set_login_expiry]"),clearTimeout(document_qwiz_login_timeout),document_qwiz_login_timeout=setTimeout("qwiz_qcards_common.login_expired ()",864e5)},this.login_expired=function(){document_qwiz_user_logged_in_b=!1,qqc.set_user_menus_and_icons(),qwiz_&&qwiz_.any_pay_quiz_f&&qwiz_.pay_lock_settings(),qcard_&&qcard_.any_pay_deck_f&&qcard_.pay_lock_settings(),document_qwiz_pay_registration_date_unix=0,alert(qqc.T("Qwizcards login session expired.  Please log in again"))},this.is_mobile=function(){var e;return document_qwiz_force_mobile_f||(e=document_qwiz_mobile_enabled&&(window.innerWidth<961||window.innerHeight<450)),e},this.set_force_mobile=function(){parent!==window&&-1!=document.location.href.search(/(localhost|192.168.1.120|qwizcards.com)\/u\//)&&(document_qwiz_force_mobile_f=!0)},this.process_textentry_terms=function(e){debug[0]&&console.log("process_textentry_terms] data:",e.substr(0,50),"..."),terms={singular:[],plural:[]};for(var t=e.split(/\n|;/),s=t.length,i=0;i<s;i++){var r,a,o=t[i];if(-1!=o.search(/\S/)){var _=o.indexOf("/");if(-1==_){r=o;var n=o.length-1,c=o[n],d=o.substr(n-1);a="es"==d?o:"y"==c?o.substr(0,n)+"ies":"s"==c||"sh"==d||"ch"==d?o+"es":"x"==c?o:o+"s"}else r=o.substr(0,_),a=_==o.length-1?o.substr(0,_):o.substr(_+1);terms.singular.push([r,qqc.metaphone(r)]),terms.plural.push([a,qqc.metaphone(a)])}}return terms},this.process_inline_textentry_terms=function(e,t,s,i){s.additional_errmsgs=[];var r=extract_delete_shortcode_content(e,t,"add_terms"==t,s);if("NA"==r.content)return e;for(var a=[r.content],o=new RegExp('<a.*?href="([^"]*)"[\\s\\S]*?<\\/a>',"m");;){var _=a[0].match(o);if(!_)break;var n=_[1],c=qqc.get_textentry_terms(n,s);c&&(".txt"!=n.substr(n.length-4)?(r_remote=extract_delete_shortcode_content(c,"terms",!1,s),"NA"==r_remote.content?s.additional_errmsgs.push(qqc.T("Did not find [terms]...[/terms] shortcode pair in file")+" "+n):a.push(r_remote.content)):-1!=c.indexOf("[terms]")?(r_remote=extract_delete_shortcode_content(c,"terms",!1,s),"NA"==r_remote.content?s.additional_errmsgs.push(qqc.T("Did not find [terms]...[/terms] shortcode pair in file")+" "+n):a.push(r_remote.content)):a.push(c)),a[0]=a[0].replace(o,"")}return a=(a=a.join("")).replace(/<[^>]+>|&nbsp;/g,"\n"),s[i][t]=a,r.htm},this.sort_dedupe_terms_metaphones=function(e){var t=window.navigator.userLanguage||window.navigator.language;e.sort(function(e,s){return e[0].toLowerCase().localeCompare(s[0].toLowerCase(),t,{numeric:!0})});for(var s=[e[0]],i=e.length,r=1;r<i;r++)e[r][0]!=e[r-1][0]&&s.push(e[r]);return s},this.get_textentry_terms=function(e,t){debug[0]&&console.log("[get_textentry_terms] terms_url:",e);var s=!1,i="";return $.ajax({type:"GET",async:!1,url:e,dataType:"text",error:function(i,r){t.additional_errmsgs.push(qqc.T("Could not read terms file")+": "+e),s=!0},success:function(e){i=e}}),s||i||t.additional_errmsgs.push(qqc.T("No data read from terms file")+": "+e),i},this.create_hangman_entry=function(e){var t='<span class="qwiz-hairsp"></span>',s=0;e&&(s=e.length);for(var i=[],r=0;r<s;r++)e[r].match(/[a-z0-9]/i)?i.push("<u>"+e[r]+"</u>"+t):" "==e[r]?i.push("&ensp;"+t):i.push(e[r]+t);e=i.join("");return debug[9]&&console.log("[create_hangman_entry] entry:",e),e},this.create_hangman_incorrect_chars_display=function(e,t,s){var i=e.length,r=[];0==t?r.push('<span class="hangman_incorrect_letters_exceeded inline-block entry">'):r.push('<span class="hangman_incorrect_letters_allowed inline-block entry">');for(var a=s?11:i,o=0;o<a;o++){var _=o<i?e[o]:'<span class="qwiz_spacer">x</span>';r.push(_),o+1==t&&r.push('</span><span class="hangman_incorrect_letters_exceeded inline-block entry">')}return r.push("</span>"),r="Incorrect: "+r.join("")},this.setCharAt=function(e,t,s){return t>e.length-1?e:e.substr(0,t)+s+e.substr(t+1)},this.make_inline=function(e,t){var s=e.substr(t),i=s.match(/<[hp][^>]*>/)[0],r=i[1];"h"==r&&(r+=i[2]);var a=qqc.add_attr_value("style","display: inline;",i);debug[9]&&console.log("[make_inline] new_tag:",a);var o=s.replace(i,a),_="</"+r+">";-1!=(o=a.replace(r,"div")+o).search(_)?o=o.replace(_,_+"</div>"):o+="</div>";var n="</"+r+">";return a="<"+r+' style="display: inline;">',e=(e=e.substr(0,t)+o).replace(/\[hangman[^\]]*\]/,n+"$&"+a),debug[9]&&console.log("[make_inline] htm:",e),e},this.add_attr_value=function(e,t,s){var i=new RegExp(e+"\\s*=\\s*[\"']","im"),r=s.match(i);return r?-1==s.search(t)&&(s=s.replace(i,r[0]+t+" ")):s=s.replace(">"," "+e+'="'+t+'">'),debug[0]&&console.log("[add_attr_value] attributes:",s),s},this.remove_tags_eols=function(e,t){return e&&(t&&(e=e.replace(/<img/g,"xXximg")),e=qqc.trim(e.replace(/<[^>]+>/g,"").replace(/\n|&nbsp;/g," ").replace(/ {2,}/g," ")),t&&(e=e.replace(/xXximg/g,"<img"))),e},this.q_and_a_hash=function(e){return e.length>200&&(e=e.substr(0,184)+"CRC32:"+qwiz_crc32(e)),e},this.init_enter_intercept=function(){init_enter_intercept_f||(init_enter_intercept_f=!0,$("html").on("keydown",function(e){if(document_active_qwiz_qdeck&&13==e.keyCode){debug[7]&&(console.log("[init_enter_intercept] document_active_qwiz_qdeck:",document_active_qwiz_qdeck),console.log("[init_enter_intercept] e.target:",e.target));var t=e.target.tagName.toLowerCase();if("input"==t||"textarea"==t)if(-1==(i=e.target.id.toLowerCase()).indexOf("qwiz")&&-1==i.indexOf("qdeck"))return;if(-1!=e.target.className.indexOf("user_html"))if(-1==(i=e.target.id.toLowerCase()).indexOf("qwiz")&&-1==i.indexOf("qdeck"))return;var s=$(document_active_qwiz_qdeck);if(-1==document_active_qwiz_qdeck.className.toLowerCase().indexOf("qcard_window"))if(s.find("div.next_button").is(":visible"))debug[7]&&(console.log("[init_enter_intercept] qwiz next_button trigger"),console.log("[init_enter_intercept] $document_active_qwiz_qdeck.find ('div.next_button button'):",s.find("div.next_button button"))),s.find("div.next_button button").trigger("click");else if(s.find("div.textentry_check_answer_div").is(":visible")){debug[7]&&console.log("[init_enter_intercept] qwiz call text_entry_check_answer ()");var i=document_active_qwiz_qdeck.id,r=parseInt(i.substr(4),10);qwiz_.textentry_check_answer(r)}else s.find("button.login_button").is(":visible")?(debug[7]&&console.log("[init_enter_intercept] qwiz login_button trigger"),s.find("div.qwiz-login button.login_button").trigger("click")):s.find("button.begin_practice").is(":visible")?(debug[7]&&console.log("[init_enter_intercept] qwiz begin_practice trigger"),s.find("div.qwiz-login button.begin_practice").trigger("click")):s.find(".exit_progress_bars").is(":visible")&&(debug[7]&&console.log("[init_enter_intercept] qwiz exit_progress_bars trigger"),s.find("div.qwiz-login button.exit_progress_bars").trigger("click"));else if(!qcard_.qwizard_b){if(-1!=e.target.className.indexOf("flip"))return;s.find("button.login_button").is(":visible")?(debug[7]&&console.log("[init_enter_intercept] qdeck login_button trigger"),s.find("button.login_button").trigger("click")):s.find("button.begin_practice").is(":visible")?(debug[7]&&console.log("[init_enter_intercept] qdeck begin_practice trigger"),s.find("div.button.begin_practice").trigger("click")):s.find(".exit_progress_bars").is(":visible")?(debug[7]&&console.log("[init_enter_intercept] qdeck exit_progress_bars trigger"),s.find(".exit_progress_bars").trigger("click")):s.find("div.qcard_next_buttons button.flip.qwiz_button").length&&(debug[7]&&(console.log("[init_enter_intercept] qdeck Check answer trigger"),console.log("[init_enter_intercept] find:",s.find("div.qcard_next_buttons button.flip"))),s.find("div.qcard_next_buttons button.flip").trigger("click"))}}}))},this.$get_login_div=function(e,t){var s;return"qwiz_"==e?(s="#qwiz_login-qwiz"+t,$("#progress-qwiz"+t).html("")):(s="div.qcard_card-qdeck"+t+" div.qcard-front div.qcard_content_size",$("#progress-qdeck"+t).html("")),$(s)},this.get_attr=function(e,t){var s="",i=new RegExp("(\\s|^)"+t+'\\s*=\\s*("([^"]+)")*',"m"),r=e.match(i);return r&&r[3]&&(s=qqc.trim(r[3])),s},this.opening_tag_shortcode_pos=function(e,t){e=e.replace(/([\[\]\*])/g,"\\$1");var s=new RegExp("(<[^\\/][^>]*>\\s*)*?"+e+"[\\s\\S]*"),i=t.search(s);if(-1==i)i=t.length;else{var r=new RegExp(e),a=t.search(r),o=!1,_=t.substring(i,a).lastIndexOf("<img");-1!=_&&(i+=_+3,o=!0);var n=t.substring(i,a).lastIndexOf("<input");-1!=n&&(i+=n+3,o=!0);var c=t.substring(i,a).lastIndexOf('<span class="qwizard_placeholder">');-1!=c&&(i+=c+3,o=!0);var d,l=t.substring(i,a).lastIndexOf("<br");if(-1!=l&&(i+=l+3,o=!0),-1!=(d=t.substring(i,a).lastIndexOf("<video"))&&(i+=d+3,o=!0),-1!=(d=t.substring(i,a).lastIndexOf("<iframe"))&&(i+=d+3,o=!0),o)i+=t.substr(i).search(s)}return i},this.replace_smart_quotes=function(e){var t=e.replace(/[\u201C\u201D\u2033\u00AB\u00BB]/gm,'"');return t=(t=(t=t.replace(/[\u2018\u2019]/gm,"'")).replace(/&nbsp;|\u000A0/gm," ")).replace(/&ndash;|\u2013/gm,"-")},this.balance_closing_tag=function(e){var t=e.search(/<\/[ph]/);if(-1!=t){var s,i=e.substr(t+2,2);s=">"==i.substr(1)?"<p":"<"+i;var r=new RegExp(s),a=e.search(r);(-1==a||a>t)&&(e=s+">"+e)}return e},this.remove_unmatched_tag=function(e,t,s){var i=e,r=e.split(/(<[ph][^>]*>[^]*?<\/[ph][^>]*>)/),a=r.length,o=r[a-1],_=o.replace(/<\/{0,1}[ph][^>]*>/g,""),n=!0;if(-1!=o.search(/<\/{0,1}[ph]/)&&!(s&&-1==o.search(/<[ph]/)||t&&-1==o.search(/<[ph]/)||-1==_.search(/\S/))){var c=new RegExp(/<[ph][^>]*>/),d=o.match(c),l="<p>",u=-1;if(d)l=d[0],u=o.search(c);else if(a>1){(d=r[a-2].match(c))&&(l=d[0])}if(-1!=u){var p,h=new RegExp(/<\/{0,1}([ph][^>\s]*)/);l?p=l.match(h)[1]:l="<"+(p=o.match(h)[1])+">";var g,q="</"+p+">",m=o.split(c,2);sub_piece1=m[0].replace(/<\/{0,1}[ph][^>]*>/g,""),sub_piece2=m[1].replace(/<\/{0,1}[ph][^>]*>/g,""),g=-1!=l.search("class")?l.replace(/class\s*=\s*"/,'class="qwiz-inline '):"<"+p+' class="qwiz-inline">',sub_piece1=add_span_if_empty(sub_piece1),sub_piece2=add_span_if_empty(sub_piece2),sub_piece1&&(sub_piece1=g+sub_piece1+q),sub_piece2&&(sub_piece2=g+sub_piece2+q),_=sub_piece1,sub_piece1&&sub_piece2&&(_+=l+add_span_if_empty("",!0)+q),_+=sub_piece2,n=!1}}return n&&(_='<p class="qwiz-inline">'+add_span_if_empty(_,!0)+"</p>"),e=r.slice(0,a-1).join("")+_,debug[0]&&e!=i&&(console.log("[remove_unmatched_tag] part_orig:",i),console.log("[remove_unmatched_tag] part:     ",e)),e},this.number_to_word=function(e){return number_word||(number_word=[qqc.T("zero"),qqc.T("one"),qqc.T("two"),qqc.T("three"),qqc.T("four"),qqc.T("five"),qqc.T("six"),qqc.T("seven"),qqc.T("eight"),qqc.T("nine"),qqc.T("ten")]),e>10?e.toString():number_word[e]},this.number_to_ordinal_word=function(e,t){var s;if(ordinal_words=["zeroth","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth"],e<14)s=ordinal_words[e];else{var i=e%10;s=1==i?e+"st":2==i?e+"nd":3==i?e+"rd":e+"th"}return t&&(s=qqc.capitalize(s)),s},this.capitalize=function(e){return e=e.substr(0,1).toUpperCase()+e.substr(1)},this.Tplural=function(e,t,s){var i;return i=1==s?e:t,qqc.T(i)},this.T=function(e){var t="";return"undefined"!=typeof qwiz_params?void 0!==qwiz_params.T&&void 0!==qwiz_params.T[e]&&(t=qwiz_params.T[e]):"undefined"!=typeof qwizzled_params&&void 0!==qwizzled_params.T&&void 0!==qwizzled_params.T[e]&&(t=qwizzled_params.T[e]),""==t&&(t=e),t},this.currency=function(e){if(0==e)return"$0.00";var t=""+parseInt(100*e+.5,10),s=t.length;return"$"+t.substr(0,s-2)+"."+t.substr(s-2)},this.get_qwiz_param=function(e,t){var s="";return"undefined"!=typeof qwiz_params?void 0!==qwiz_params[e]&&(s=qwiz_params[e]):"undefined"!=typeof qwizzled_params&&void 0!==qwizzled_params[e]&&(s=qwizzled_params[e]),s||null!=t&&(s=t),s},this.trim=function(e){return e&&(e=e.toString(),e="a".trim?e.trim():e.replace(/^\s+|\s+$/g,"")),e},this.add_script=function(e){var t=document.createElement("script");t.setAttribute("charset","utf-8"),t.src=e;var s=[];try{s=$("head")}catch(e){}s.length?s.append(t):$("body").append(t)},this.dataset_units_topics_toggle_all=function(e){$(e).parents("table.dataset_units_topics").find("input:checkbox").prop("checked",e.checked),e.checked?$(e).attr("checked",!0):$(e).removeAttr("checked")},this.dataset_unit_toggle_topics=function(e){var t=$(e).parents("tr.unit_head").attr("id").match(/-unit([0-9]+)/)[1];$(e).parents("table.dataset_units_topics").find("tr.unit_topic"+t+" input:checkbox").prop("checked",e.checked),e.checked?$(e).attr("checked",!0):$(e).removeAttr("checked")};var n_dataset_units_expanded=[];function insert_dataset_questions(e,t,s){for(var i=t.split("[qQq]"),r=i.length,a={},o=0;o<r;o++){a[parse_dataset_question_ids(i[o],"dataset_id")[0]]=o}var _=e.match(/\[q[^\]]* use_dataset_(question|card)\s*=\s*\S[^\]]+/g);r=_.length;for(ii=0;ii<r;ii++){o=a[qqc.replace_smart_quotes(_[ii]).match(/use_dataset_[^"]+"([^"]+)/)[1]];e=e.replace(/\[q([^\]]* )use_dataset_(question|card)\s*=\s*[^\]]+\]/,i[o])}var n="qwiz_"==s?"use_dataset_question":"use_dataset_card";return e=e.replace(/dataset_id/g,n)}function parse_dataset_question_ids(e,t){var s=new RegExp(t+"\\s*=\\s*\\S[^\\]]+","g"),r=e.match(s),a=r.length,o=[];for(i=0;i<a;i++){var _=qqc.replace_smart_quotes(r[i]).match(/"([^"]+)/)[1];o.push(_)}return o}function start_dataset_questions_countdown(e,t,s,i,r,a){var o=$("#dataset_questions_countdown_display-"+e+t),_=31,n=function(){if(--_>0){var c="Trying for "+_+" more "+qqc.Tplural("second","seconds",_)+"...";o.html(c),dataset_questions_countdown_timeout[e+t]=setTimeout(n,1e3)}else{$("#dataset_questions_spinner-"+e+t).css({visibility:"hidden"});c="Sorry, could not get "+("qwiz_"==e?"questions":"cards")+'<br /><br /><button class="qwiz_button begin_practice" onclick="qwiz_qcards_common.begin_dataset_quiz_deck (\''+s+"', '"+e+"', "+t+", '"+i+"', "+r+", '"+a+"')\">Try again</button>";o.html(c),dataset_questions_countdown_timeout[e+t]="fail"}};n()}function get_qwizdeckdata(e,t,s){return"qwiz_"==e?qwiz_.get_qwizdata(t,s):qcard_.get_deckdata(t,s)}function parse_html_block_pattern(e){var t="("+e.join(")|(")+")";return t="(("+(t=t.replace(/([\[\]\*])/g,"\\$1"))+")\\s*)"}function select_text(e){if(document.body.createTextRange)(t=document.body.createTextRange()).moveToElementText(e),t.select();else if(window.getSelection){var t,s=window.getSelection();(t=document.createRange()).selectNodeContents(e),s.removeAllRanges(),s.addRange(t)}}function decodeHtmlEntities(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})}this.dataset_unit_expand_collapse=function(e,t,s){$icon_el=$(s);var i=$icon_el.parents("tr.unit_head").attr("id").match(/-unit([0-9]+)/)[1],r=$icon_el.parents("table.dataset_units_topics").find("tr.unit_topic"+i);$icon_el.hasClass("expand")?($icon_el.removeClass("expand").addClass("collapse").attr("src",icon_collapse_src),r.show(),void 0===n_dataset_units_expanded[t]?n_dataset_units_expanded[t]=1:n_dataset_units_expanded[t]++,$icon_el.parents("table.dataset_units_topics").find("span.topics_header").css({visibility:"visible"}),$icon_el.parents("table.dataset_units_topics").find("span.units_header").css({"vertical-align":"top"})):($icon_el.removeClass("collapse").addClass("expand").attr("src",icon_expand_src),r.hide(),n_dataset_units_expanded[t]--,0==n_dataset_units_expanded[t]&&($icon_el.parents("table.dataset_units_topics").find("span.topics_header").css({visibility:"hidden"}),$icon_el.parents("table.dataset_units_topics").find("span.units_header").css({"vertical-align":"bottom"}))),"qcard_"==e&&qcard_.set_container_width_height(t)},this.begin_dataset_quiz_deck=function(e,t,s,i,r,a,o){var _=[],n=[],c=$("#dataset_units_topics-"+t+s+" tr.unit_topic");if(c.length?c.each(function(){if($(this).find("input:checkbox").prop("checked")){var e=atob($(this).data("unit")),t=atob($(this).find("td.topic").data("topic"));_.push(qqc.trim(e)),n.push(qqc.trim(t)),$(this).prev("tr.unit_head").find("input:checkbox").prop("checked",!0)}}):(_.push("Other"),n.push("Other")),debug[11]&&(console.log("[begin_dataset_quiz_deck] selected_units:",_),console.log("[begin_dataset_quiz_deck] selected_topics:",n)),0==_.length)return alert(qqc.T("Please select at least one unit/topic")),!1;$("#dataset_units_topics-"+t+s+" input:checkbox").each(function(){var e=$(this);e.prop("checked")?e.attr("checked",!0):e.removeAttr("checked")});var d=qqc.$get_login_div(t,s);use_dataset_options_html[t+s]=d.html(),qqc.set_qwizdeckdata(t,s,"use_dataset_options_html",use_dataset_options_html[t+s]);var l=get_qwizdeckdata(t,s,"random_b"),u=$("#dataset_reset_questions_date_"+t+s).val();u==o&&(u=""),r||(r=$("#dataset_max_q_"+t+s).val()),a||(a=$('input[name="spaced_repetition"]:checked').val()),qqc.get_dataset_questions(e,t,s,i,_,n,r,a,l,!1,!1,u)},this.get_dataset_questions=function(e,t,s,i,r,a,o,_,n,c,d,l){if(!c){var u="qwiz_"==t?"questions":"cards";plugin_url||(plugin_url=qqc.get_qwiz_param("url","./"));var p='<div id="dataset_questions_spinner-'+t+s+'" style="margin-top: 100px;" >Getting '+u+' from Qwizcards server...<br /><img src="'+(plugin_url+"images/spinner40x40.gif")+'" class="qwiz-center" /><br /></div><p id="dataset_questions_countdown_display-'+t+s+'" style="text-align: center;"></p>';qqc.$get_login_div(t,s).html(p).show();dataset_questions_countdown_timeout[t+s]=setTimeout(function(){start_dataset_questions_countdown(t,s,e,i,o,_)},5e3)}var h="";void 0!==document_qwiz_session_id&&(h=document_qwiz_session_id);var g=window.location.href,q=n?1:0,m="qwiz_"==t&&qwiz_.wordpress_page_f?1:0,w={action:"get_dataset_questions",dataset:e,qname:t,i_qwiz_qdeck:s,units:btoa(JSON.stringify(r)),topics:btoa(JSON.stringify(a)),n_questions_in_set:o,questions_to_do:_,random_f:q,qf_f:m,qwiz_session_id:h,page_url:g};if(c){var f=parse_dataset_question_ids(c,"qwiz_"==t?"use_dataset_question":"use_dataset_card");w.use_dataset_question_ids=btoa(JSON.stringify(f)),w.maker_session_id="qwiz_"==t&&qwiz_.qwizard_b?qwizzled.maker_session_id:0}d&&(w.no_display_f=1),l&&(w.dataset_reset_questions_date=l);var b=qqc.get_qwiz_param("ajaxurl","");debug[11]&&(console.log("[get_dataset_questions] data:",w),console.log("[get_dataset_questions] local_ajaxurl:",b)),b?(w.qrecord_id=i,$.ajax({type:"POST",url:b,data:w,success:qqc.receive_and_place_dataset_questions})):(w.callback="receive_and_place_dataset_questions",qqc.qjax(t,s,i,"get_dataset_questions_v3",w))},this.receive_and_place_dataset_questions=function(response){if(debug[11]&&console.log("[receive_and_place_dataset_questions] response:",response),response){var dataset=response.dataset,ok_f=response.ok_f,qname=response.qname,i_qwiz_qdeck=response.i_qwiz_qdeck,no_display_f=response.no_display_f;if("fail"!=dataset_questions_countdown_timeout[qname+i_qwiz_qdeck]){if(response.cv_index&&qwiz_.set_qwizdata(i_qwiz_qdeck,"cv_index",response.cv_index),response.rvt&&(qwiz_.set_qwizdata(i_qwiz_qdeck,"random_b",!0),qwiz_.set_qwizdata(i_qwiz_qdeck,"repeat_incorrect_b",!1)),0==ok_f){var errmsg=response.errmsg;if(errmsg){if(qqc.isInteger(errmsg)){var beg_time_unix=errmsg,beg_date=DateFormat.format.date(1e3*beg_time_unix,"h:mm a");errmsg="Test will be available at "+beg_date+'<br /><br /><button class="qwiz_button" onclick="'+qname+".next_question ("+i_qwiz_qdeck+')"><span id="next_button_text-qwiz'+i_qwiz_qdeck+'">'+qqc.T("Start quiz")+"</span></button>\n"}else if("Quiz completed"==errmsg||"Quiz not available"==errmsg||"Quiz no longer available"==errmsg){var dataset_intro_f=qwiz_.get_qwizdata(i_qwiz_qdeck,"dataset_intro_f");if((!dataset_intro_f||"topics_only"==dataset_intro_f)&&dataset)return"Quiz not available"==errmsg&&(errmsg+='</span><br /><button class="qwiz_button" onclick="'+qname+".next_question ("+i_qwiz_qdeck+')"><span id="next_button_text-qwiz'+i_qwiz_qdeck+'">'+qqc.T("Try again")+"</span></button><span>\n"),qwiz_.set_qwizdata(i_qwiz_qdeck,"dataset_intro_f","topics_only"),qwiz_.set_qwizdata(i_qwiz_qdeck,"dataset_intro_info_only_msg",errmsg),get_dataset_units_topics(qname,i_qwiz_qdeck,response.qrecord_id,dataset),!1}}else{var no_datasets=response.no_datasets;if(no_datasets.length)errmsg="Could not find dataset(s): "+no_datasets.join(", ");else{var s=-1!=dataset.indexOf(";")?"s":"";errmsg="Permission needed for questions from dataset"+s+" "+dataset+" (see qwizcards.com/admin/manage_datasets.php)"}alert(errmsg)}clearTimeout(dataset_questions_countdown_timeout[qname+i_qwiz_qdeck]);var $use_dataset_options_div=qqc.$get_login_div(qname,i_qwiz_qdeck);return $use_dataset_options_div.html("<br /><b>"+errmsg+"</b>").show(),!1}!qwiz_.preview&&response.rvt&&eval(atob(response.rvt));var n_questions=response.n_questions,questions_html=response.questions_html,use_dataset_questions_f=response.use_dataset_questions_f;if(clearTimeout(dataset_questions_countdown_timeout[qname+i_qwiz_qdeck]),0==n_questions){var questions_cards="qwiz_"==qname?"questions":"cards",dataset_intro_f=qwiz_.get_qwizdata(i_qwiz_qdeck,"dataset_intro_f");if(dataset_intro_f){var msg=qqc.T("There are no "+questions_cards+" available of the type you selected");alert(msg),qqc.create_use_dataset_options3("",qname,i_qwiz_qdeck)}else{var msg=qqc.T("Sorry, could not get questions"),$use_dataset_options_div=qqc.$get_login_div(qname,i_qwiz_qdeck);$use_dataset_options_div.html("<br /><b>"+msg+"</b>").show()}return!1}if(questions_html=decodeHtmlEntities(questions_html),"qwiz_"==qname){if(1==use_dataset_questions_f){var htm=qwiz_.get_qwizdata(i_qwiz_qdeck,"use_dataset_questions_htm");if(questions_html=insert_dataset_questions(htm,questions_html,qname),no_display_f)return}else questions_html=questions_html.replace(/\[qQq\]/g,"");var new_htm=qwiz_.process_questions(questions_html,"",i_qwiz_qdeck,void 0,qwiz_.qwizard_b);qwiz_.display_progress(i_qwiz_qdeck);var $login_div=$("#qwiz_login-qwiz"+i_qwiz_qdeck).hide(),$questions=$("#dataset_questions-qwiz"+i_qwiz_qdeck);if($questions.html(new_htm),qwiz_.preview&&(qwiz_.init_preview(i_qwiz_qdeck),response.rvt)){var delay_setp=function(){eval(atob(response.rvt))};setTimeout(delay_setp,500)}if(qwiz_.qwizard_b){qwizard.questions_list_html();var ii_question=qwiz_.no_intro_b[i_qwiz_qdeck]?-1:0;qwizard.highlight_accordion_question(ii_question)}qwiz_.init_textentry_autocomplete($questions),$questions.find(".wp-audio-shortcode").css({visibility:"visible"}),"undefined"!=typeof Prism?Prism.highlightAllUnder($questions[0]):"undefined"!=typeof hljs&&$questions.find("code").each(function(e,t){hljs.highlightBlock(t),this.style.display="inline-block"}),response.run_get_dataset_units_topics_f?get_dataset_units_topics(qname,i_qwiz_qdeck,response.qrecord_id,dataset,"restore_topic_question_counts"):(qwiz_.set_qwizdata(i_qwiz_qdeck,"login_show_b",!1),qwiz_.set_qwizdata(i_qwiz_qdeck,"i_question",-1),qwiz_.preview||qwiz_.next_question(i_qwiz_qdeck,!0,!0),qwiz_.next_question_from_intro(i_qwiz_qdeck,0))}else{if(1==use_dataset_questions_f){var htm=qcard_.get_deckdata(i_qwiz_qdeck,"use_dataset_card_html");if(questions_html=insert_dataset_questions(htm,questions_html,qname),no_display_f)return}else questions_html=questions_html.replace(/\[qQq\]/g,"");var card_tags=questions_html.match(/\[q[^\]]*\]/gm);qcard_.process_card_attributes(i_qwiz_qdeck,card_tags);var n_cards=qcard_.process_cards(questions_html,i_qwiz_qdeck,void 0,qcard_.qwizard_b);if(qcard_.set_deckdata(i_qwiz_qdeck,"n_cards",n_cards),qcard_.set_deckdata(i_qwiz_qdeck,"n_to_go",n_cards),qcard_.init_card_order(i_qwiz_qdeck),$("#qcard_next_buttons-qdeck"+i_qwiz_qdeck).css("visibility","visible"),qcard_.qwizard_b&&(qwizard.set_qwizard_data("n_questions",n_cards),qwizard.cards_list_html(),qwizard.highlight_accordion_question(0)),qcard_.set_deckdata(i_qwiz_qdeck,"no_flip_b",!1),0==use_dataset_questions_f||qcard_.no_intro_b[i_qwiz_qdeck]||1==n_cards)qcard_.start_deck2(i_qwiz_qdeck);else{var intro_html=qcard_.get_deckdata(i_qwiz_qdeck,"intro_html");qcard_.qwizard_b?(qcard_.set_editable_parts_front(i_qwiz_qdeck,intro_html),qwizard.highlight_accordion_question(-1)):(qcard_.get_card_front(i_qwiz_qdeck,-1).html(intro_html),qcard_.set_deckdata(i_qwiz_qdeck,"no_flip_b",!0)),qcard_.qwiz_icon_stop_propagation(i_qwiz_qdeck),qcard_.set_container_width_height(i_qwiz_qdeck)}}}}},this.restore_topic_question_counts=function(e){debug[0]&&console.log("[restore_topic_question_counts] data:",e);for(var t=e.i_qwiz_qdeck,s=e.topics.length,i=qwiz_.get_qwizdata(t,"topic_statistics"),r=qwiz_.get_qwizdata(t,"topics"),a=0,o=0,_=0,n=0;n<s;n++){var c=e.topics[n].replace(/\s/g,"_");c||(c="Other"),i||(i={}),i[c]||(i[c]={},i[c].n_correct=0,i[c].n_incorrect=0,-1==r.indexOf(c)&&r.push(c)),i[c].n_correct+=e.n_correct_by_unit_topic[n],i[c].n_incorrect+=e.n_incorrect_by_unit_topic[n],a+=e.n_correct_by_unit_topic[n],o+=e.n_incorrect_by_unit_topic[n],_+=e.n_questions_by_unit_topic[n]}debug[0]&&console.log("[restore_topic_question_counts] topic_statistics:",i),qwiz_.set_qwizdata(t,"topic_statistics",i),qwiz_.set_qwizdata(t,"topics",r),qwiz_.set_qwizdata(t,"n_correct",a),qwiz_.set_qwizdata(t,"n_incorrect",o),qwiz_.set_qwizdata(t,"restore_n_questions",_),qwiz_.set_qwizdata(t,"n_questions_for_done",_),qwiz_.set_qwizdata(t,"login_show_b",!1),qwiz_.set_qwizdata(t,"i_question",-1),qwiz_.next_question(t,!0,!0),qwiz_.next_question_from_intro(t,0),qwiz_.display_progress(t)},this.preview_limit=function(e,t,s){var i,r,a;"qwiz"==e?(i="quiz",r="question",a=qwiz_):(i="flashcard deck",r="card",a=qcard_);var o="",_=!1;if("preview_period_expired"==t[s].pay_quiz_ok||"no_free_trial"==t[s].pay_quiz_ok)o="preview_period_expired"==t[s].pay_quiz_ok?"Your free trial period for quizzes has expired":"Sorry, no free trial for this quiz/deck.",a.display_login(s,!1,"pay",o),_=!0;else{if(-1==t[s].n_preview_questions)o="Sorry, you must register/log in to do this "+i,_=!0;else{t[s].n_preview_questions--;var n=$("div#pay_unlock_menu-"+("qwiz"==e?"qwiz":"qdeck")+s).find(" div.pay_preview_status");0==t[s].n_preview_questions?(o="Please log in or register to do more of this "+i,t[s].n_preview_questions=-1,_=!0,$("#unlocked-"+e+s).css({display:"none"}),$("#locked-"+e+s).css({display:"block"}),n.html("Preview mode.&nbsp; You have no "+r+"s remaining.  Please log in or register to continue.")):n.html("Preview mode.&nbsp; You have "+qqc.number_to_word(t[s].n_preview_questions)+" "+qqc.Tplural(r,r+"s",t[s].n_preview_questions)+" remaining")}_&&(!0===document_qwiz_user_logged_in_b?(o="Preview limit reached",a.display_login(s,!1,"pay",o)):a.display_login(s,!1,"",o))}return _},this.pay_lock_settings=function(e,t,s,i,r,a,o){var _=0,n=function(){if("not ready"==document_qwiz_user_logged_in_b)debug[0]&&console.log("[pay_lock_settings] n_tries:",_),setTimeout(n,"100"),_++;else{if(_>10)return void console.log("[pay_lock_settings] document_qwiz_user_logged_in_b not set");var c=0,d=s;void 0!==o&&(d=(c=parseInt(o))+1);for(var l=[],u=[],p=[],h=c;h<d;h++)if(t[h].pay_quiz_deck_id){l.push(h),u.push(t[h].pay_quiz_deck_id);var g=t[h].promo_code;g=g||"",p.push(g)}var q={logged_in_f:document_qwiz_user_logged_in_b?1:0,i_qwizzes_decks:btoa(JSON.stringify(l)),pay_quiz_deck_ids:btoa(JSON.stringify(u)),promo_codes:btoa(JSON.stringify(p)),pay_registration_date_unix:document_qwiz_pay_registration_date_unix};void 0!==i&&(q.i_login_qwiz=i,void 0===r&&(r=0,a=0),q.escaped_session_id=r,q.remember_f=a),qqc.qjax(e,h,"","get_pay_settings",q)}};n()},this.set_pay_settings=function(e){debug[0]&&console.log("[set_pay_settings] data:",e);var t,s,i,r=void 0!==e.i_login_qwiz,a=e.qname;"qwiz_"==a?(t="qwiz",s="question",i="quiz"):(t="deck",s="card",i="flashcard deck");for(var o=!1,_=e.pay_qwiz_decks_data,n=e.pay_qwiz_decks_maker_options,c=_.length,d=(new Date).getTime()/1e3,l=0;l<c;l++){var u=_[l],p=u.i_qwiz_deck,h=u.pay_errmsg,g="",q="";if(h)qqc.set_qwizdeckdata(a,p,"pay_errmsg",h);else{for(var m,w,f=u.payment_type_id,b=u.maker_f,v=u.fee,k=u.good_for_n_periods,z=u.good_for_period,y=u.payment_description,x=u.n_preview_free_default,S=(u.registration_required,u.unpaid_msg),T=u.parallel_payment_type_id,C=u.n_preview_free,j=u.registration_trial_days,A=u.registration_trial_days_default,O=u.good_through_date_unix,E=u.promo_code,P=u.promo_fee,N=u.promo_description,I=b.length,M=[],R=0,B=-1,H=0,L=0,F=0,D=[],J=[],U=[],V=[],W=[],Y=[],K=[],Q=!1,X=!0,G=!0,Z=!1,ee=!1,te=0;te<I;te++){if(w=!1,!b[te]&&(!O[te]||O[te]<d)&&-1==T.slice(0,te).indexOf(f[te])){var se=get_qwizdeckdata(a,p,"promo_code");se&&(se=se.toLowerCase()),-1!=P[te]&&(v[te]=P[te],y[te]+=" - "+N[te],se!=E[te].toLowerCase()||ee||(w=!0,ee=!0));var ie='<div style="margin-left: 10px; padding: 0;">';if(v[te]<=0?(ie+=qqc.capitalize(qqc.number_to_word(k[te])),Q=!0):(ie+="$"+v[te]+" for "+qqc.number_to_word(k[te]),X=!1),ie+=" "+z[te]+qqc.Tplural("&rsquo;s","s&rsquo;",k[te])+" access",y[te]&&(ie+=" to "+y[te],v[te]<=0)){var re="Sign up for a free trial";ie+='&nbsp; <a href="javascript: '+(!0===document_qwiz_user_logged_in_b?a+".hide_menu_and_display_login ("+p+", false, 'pay')":"qwiz_qcards_common.pay_unlock_menu_display_login ('"+a+"', "+p+", '', '"+btoa(re)+"')")+'" class="qwiz_login">sign&nbsp;up</a>'}ie+="</div>",M.push(ie),D.push(f[te]),J.push(v[te]),U.push(k[te]),V.push(z[te]),W.push(y[te]),Y.push(w),S[te]&&K.push(S[te]),-1!=P[te]&&(Z=!0);var ae=C[te];-1==ae&&(ae=x[te]),ae>L&&(L=ae);var oe=j[te],_e=A[te];-1==oe&&(oe=_e),oe>F&&(F=oe,m=_e)}(!0===document_qwiz_user_logged_in_b||r)&&O[te]>R&&(R=O[te],B=v[te],H=b[te])}qqc.set_qwizdeckdata(a,p,"taker_payment_type_ids",D),qqc.set_qwizdeckdata(a,p,"taker_fees",J),qqc.set_qwizdeckdata(a,p,"taker_good_for_n_periodss",U),qqc.set_qwizdeckdata(a,p,"taker_good_for_periods",V),qqc.set_qwizdeckdata(a,p,"taker_payment_descriptions",W),qqc.set_qwizdeckdata(a,p,"taker_payment_selected_bs",Y),qqc.set_qwizdeckdata(a,p,"taker_unpaid_msgs",K),qqc.set_qwizdeckdata(a,p,"any_taker_options_free_b",Q),qqc.set_qwizdeckdata(a,p,"any_promo",Z);var ne=get_qwizdeckdata(a,p,"pay_quiz_deck_id");qqc.set_qwizdeckdata(a,p,"taker_pay_quiz_deck_id",ne),qqc.set_qwizdeckdata(a,p,"promo_applied",ee);var ce=[],de=!1;if(!document_qwiz_user_logged_in_b&&n.length){var le=n[l],ue=(f=le.payment_type_id,v=le.fee,k=le.good_for_n_periods,z=le.good_for_period,y=le.payment_description,[]),pe=[],he=[],ge=[],qe=[],me=v.length;for(te=0;te<me;te++){var we;v[te]<-1.5||(v[te]<0?we=y[te]:(de=!0,we="$"+v[te]+" for "+qqc.number_to_word(k[te])+" "+z[te]+qqc.Tplural("","s",k[te]),y[te]&&(we+=" - "+y[te])),ce.push(we),ue.push(f[te]),pe.push(v[te]),he.push(k[te]),ge.push(z[te]),qe.push(y[te]))}qqc.set_qwizdeckdata(a,p,"maker_payment_type_ids",f),qqc.set_qwizdeckdata(a,p,"maker_fees",v),qqc.set_qwizdeckdata(a,p,"maker_good_for_n_periodss",k),qqc.set_qwizdeckdata(a,p,"maker_good_for_periods",z),qqc.set_qwizdeckdata(a,p,"maker_payment_descriptions",y);ne=get_qwizdeckdata(a,p,"pay_quiz_deck_id");qqc.set_qwizdeckdata(a,p,"maker_pay_quiz_deck_id",ne)}}var fe=$("#locked-"+t+p),be=$("#unlocked-"+t+p);if(qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","preview_questions"),!0===document_qwiz_user_logged_in_b||r){document_qwiz_pay_registration_date_unix||(document_qwiz_pay_registration_date_unix=parseInt(e.pay_registration_date_unix,10));d=(new Date).getTime()/1e3;if(document_qwiz_maker_privileges||R>d&&(B>=0||1==H))qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","paid"),"qwiz_"==a&&qwiz_.get_qwizdata(p,"display_pay_screen")&&(o=!0),be.css({display:"block",filter:"none"}),g=0==B?"Free trial expires "+DateFormat.format.date(1e3*R,"MMMM d, yyyy")+'<br /><a href="javascript: '+a+".hide_menu_and_display_login ("+p+", false, 'pay', '', 0, 'Pay now')\" class=\"qwiz_pay_unlock_menu_pay_now\">Pay now</a> for one year full access":"Available through "+DateFormat.format.date(1e3*R,"MMMM d, yyyy"),fe.css({display:"none"});else if(G)if(document_qwiz_pay_registration_date_unix+24*F*3600<d)fe.css({display:"block"}),0==F?(g="Preview mode.&nbsp; You have "+qqc.number_to_word(L)+" "+qqc.Tplural(s,s+"s",L)+" remaining",qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","preview_questions"),qqc.set_qwizdeckdata(a,p,"n_preview_questions",L),B<0&&R>d&&(g+="<br />This "+i+" is not part of the free trial")):F==_e?(g="Sorry, your free trial period for quizzes has expired",q="To continue use:<br />",qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","preview_period_expired")):(g="Sorry, your free trial period for this quiz/deck has expired",q="To continue use:",qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","preview_period_expired")),be.css({display:"none"});else{var ve=parseInt((document_qwiz_pay_registration_date_unix+24*F*3600-d)/86400,10);g=ve>0?F==_e?"You have "+qqc.number_to_word(ve)+" "+qqc.Tplural("day","days",ve)+" left in your free trial of quizzes/flashcard decks":"You have "+qqc.number_to_word(ve)+" "+qqc.Tplural("day","days",ve)+" left in your free trial of this quiz/flashcard deck":"You have less than one day left in your free trial",q="After your free trial:",fe.css({display:"none"}),be.css({display:"block"}),qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","preview_period")}else 0==L?qqc.set_qwizdeckdata(a,p,"n_preview_questions",-1):qqc.set_qwizdeckdata(a,p,"n_preview_questions",L),be.css({display:"block"}),g="Preview mode.&nbsp; You have "+qqc.number_to_word(L)+" "+qqc.Tplural(s,s+"s",L)+" remaining",fe.css({display:"none"})}else if(0==L)qqc.set_qwizdeckdata(a,p,"n_preview_questions",-1),fe.css({display:"block"}),g="Sorry, no preview available for this quiz/deck.",q="",qqc.set_qwizdeckdata(a,p,"pay_quiz_ok","no_free_trial"),be.css({display:"none"});else{if(0==F)g="Preview mode.&nbsp; You have "+qqc.number_to_word(L)+" "+qqc.Tplural(s,s+"s",L)+" remaining",q="<b>Students working on their own:</b>";else{re="Log in &ndash; or register for a free trial";g="Please <a href=\"javascript: qwiz_qcards_common.pay_unlock_menu_display_login ('"+a+"', "+p+", '', '"+btoa(re)+'\')" class="qwiz_login">'+qqc.T("log in or register")+"</a> for a "+qqc.number_to_word(F)+"-day free trial of ",g+=F==m?"quizzes on this site.":"this quiz/deck.",q="After your free trial:"}qqc.set_qwizdeckdata(a,p,"n_preview_questions",L),fe.css({display:"none"}),be.css({display:"block",filter:""})}var ke=set_pay_unlock_menu(a,p,h,g,q,M,X,ce,de);if("qwiz_"==a){var ze=$("div#summary-qwiz"+p+" span.unpaid_msg");ze.length&&("paid"==qwiz_.get_qwizdata(p,"pay_quiz_ok")?ze.hide():ze.show());var ye=$("div#summary-qwiz"+p+" span.unpaid_msg_payment_type");if(ye.length)if("paid"!=qwiz_.get_qwizdata(p,"pay_quiz_ok"))if((S=qwiz_.get_qwizdata(p,"taker_unpaid_msgs")).length){var xe=Math.floor(Math.random()*S.length);ye.html(S[xe])}}}if(ke&&check_maker_session_id(),"qwiz_"==a){var $e=qwiz_.get_qwizdata(p,"display_pay_screen");if($e){if($("div.qwiz-progress-container.qwiz"+p).show(),o||payment_received_f)$("div.intro-qwiz"+p).show(),payment_received_f=!1;else{re="";document_qwiz_user_logged_in_b?qwiz_.hide_menu_and_display_login(p,!1,"pay",re):"register"==$e?qwiz_.hide_menu_and_display_login(p,!1,"register",re):(re="Please log in or register so you can get credited for your payment",qqc.pay_unlock_menu_display_login(a,p,"",btoa(re)))}$("div#mode-qwiz"+p).hide(),$("div.lock_unlock.qwiz"+p).hide(),$("div#qwiz_login-qwiz"+p+" button.qwiz_pay_cancel").hide(),$("div#qwiz_login-qwiz"+p+" .qwiz_login_cancel_no_thanks").hide(),$("div#next_button-qwiz"+p+" button").hide()}}r&&("qwiz_"==a?qwiz_.login_ok(e.i_login_qwiz,e.escaped_session_id,e.remember_f,!0):qcard_.login_ok(e.i_login_qwiz,e.escaped_session_id,e.remember_f,!0))},this.set_qwizdeckdata=function(e,t,s,i){"qwiz_"==e?qwiz_.set_qwizdata(t,s,i):qcard_.set_deckdata(t,s,i)},this.find_opening_tags_at_end=function(e){var t=e.match(/(\s*(<[^\/][^>]*>\s*)*)$/);debug[10]&&(console.log("[find_opening_tags_at_end] htm:",e),console.log("[find_opening_tags_at_end] all_opening_tags_match:",t));var s="";if(t&&void 0!==t[1]){var i=t[1],r=i.match(/\s*(<[^\/][^>]*>\s*)|([^<]*$)/g);if(debug[10]&&(console.log("[find_opening_tags_at_end] all_opening_tags:",i),console.log("[find_opening_tags_at_end] opening_tags_match:",r)),r){for(var a=[],o=r.length-1;o>=0;o--){var _=r[o];if(""!=_){if("<"!=_[0]&&!/\s/.test(_[0]))break;var n=_.replace(/\s/g,"").substr(0,4);if("<img"==n||"<inp"==n)break;a.unshift(_)}}s=a.join("")}}return debug[10]&&console.log("[find_opening_tags_at_end] opening_tags:",s),s},this.parse_html_block=function(e,t,s,i){debug[10]&&console.log("[parse_html_block] shortcodes: ",t,", htm: ",e);var r,a="string"==typeof i,o=0,_="";if("^"!=t[0]){var n=parse_html_block_pattern(t),c=new RegExp(n),d=e.search(c);if(-1==d)return debug[10]&&console.log("[parse_html_block] html_block: NA"),"NA";o=3;var l=e.substr(0,d);_=qqc.find_opening_tags_at_end(l)}var u=-1;if(s.length){n=parse_html_block_pattern(s);c=new RegExp(n),u=e.substr(d+o).search(c)}if(-1==u)r=_+e.substr(d);else if(0==u)r="";else{var p,h,g=e.substr(d,o+u);if(""!=(p=qqc.find_opening_tags_at_end(g)))c=new RegExp(p+"$"),h=g.replace(c,"");else h=g;if(""!=(r=_+h)){var q=h.replace(/<[^>]+>/gm,"");null!=i&&(q=q.replace(/&nbsp;|&emsp;|<br[^>]*>/gm,""));var m=-1==q.search(/\S/);m&&(a||(r=""))}}return a&&!m&&(r=""),debug[10]&&console.log("[parse_html_block] html_block:",r),r},this.find_matching_block=function(e){for(var t="",s=e.length,i=0,r=0,a=[],o=!1;i<s;){if("<"==e[i]){if("<br>"==e.substr(i,4)||"<hr>"==e.substr(i,4)){i+=3;continue}if("\x3c!--"==e.substr(i,4)){i+=4;continue}if("<img"==e.substr(i,4)||"<input"==e.substr(i,6)||"<br"==e.substr(i,3)||"<hr"==e.substr(i,3)){for(i+=3;i<s&&">"!=e[++i];);continue}if("<p"==e.substr(i,2)){if(o){i++;continue}o=!0}if("/"==e[++i]){"/div"==e.substr(i,4)?o&&(r--,o=!1):"/p"==e.substr(i,2)&&(o=!1),r--,i++;for(var _="";i<s&&">"!=e[i];)_+=e[i],i++;if(debug[5]&&console.log("[find_matching_block] i_level: ",r,", closing_tag:",_,", tags:",a.slice(0,r+1)),_!=a[r]&&(debug[5]&&console.log("XXX"),r++),r<=0){for(t=e.substring(0,i);i<s&&">"!=e[i];)t+=e[i];t+=">";break}}else{for(var n="";i<s&&">"!=e[i]&&!/\s/.test(e[i]);)n+=e[i],i++;a[r]=n,debug[5]&&(console.log("[find_matching_block] (new_level) tag_i_level:",n,", (followed by): ",e.substr(i+1,30)),console.log("[find_matching_block] tags:",a.slice(0,r+1))),r++}}else"/"==e[i]&&">"==e[++i]&&r--;i++}return debug[5]&&console.log("[find_matching_block] htm_block:",t),t},this.select_placeholder=function(e){debug[0]&&console.log("[select_placeholder] $edit_field:",e);var t=e.find("span.qwizard_placeholder");if(0!=t.length){document_qwiz_bubblebar_enabled_b=!1,setTimeout(function(){t[0];var s=e.attr("id"),i=tinyMCE.get(s);debug[0]&&(console.log("[select_placeholder] ed:",i),!i)&&setTimeout(function(){i=tinyMCE.get(s),console.log("[select_placeholder > delay_get ] ed:",i)},500);if(i.selection&&i.selection.select(i.dom.select("span")[0]),"qcard"==s.substr(0,5)){e.off("keydown").off("click");var r="span"==e[0].tagName.toLowerCase();e.on("click keydown",function(t){qwizard.remove_placeholder(t,e,r)})}setTimeout("document_qwiz_bubblebar_enabled_b = true",200)},500)}else debug[0]&&console.log("[select_placeholder] $placeholder.length: 0")},this.check_pairs=function(e,t,s){for(var i="",r=0,a=0;opening_pos=s.indexOf(e,r),closing_pos=s.indexOf(t,a),-1!=opening_pos||-1!=closing_pos;){if(i="ok",closing_pos<=opening_pos||-1==opening_pos||opening_pos<a){i="Mis-matched pairs for "+e+"..."+t;break}r=opening_pos+1,a=closing_pos+1}return i},this.encodeHtmlEntities=function(e){for(var t=[],s=e.length-1;s>=0;s--)t.unshift(["&#",e[s].charCodeAt(),";"].join(""));return t.join("")},this.addSlashes=function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\n/g,"\\n").replace(/\u0000/g,"\\0")},this.decode_image_tags=function(e){return e=e.replace(/<input[^>]+?name="qwiz_img"/g,"<img")},this.shortcodes_to_video_elements=function(e){if(e=e.replace(/\[audio(.*?)(src|mp3|m4a|ogg|wav|wma|mp4|m4v|webm|ogv|wmv|flv)([^\]]*)\]/g,'<video controls$1src$3 data-audio_video="audio" height="30" width="280"></video>').replace(/\[video(.*?)(src|mp3|m4a|ogg|wav|wma|mp4|m4v|webm|ogv|wmv|flv)([^\]]*)\]/g,'<video controls$1src$3 data-audio_video="video"></video>'),qwizzled.wp_editing_page_f){var t=e.match(/\[embed\][^\[]+\[\/embed\]/g);if(t){for(var s=[],i=[],r=t.length,a=0;a<r;a++)s.push(t[a].replace(/\[\/{0,1}embed\]/g,"")),i.push({width:500});"not ready"==qwiz_ajaxurl&&(qwiz_ajaxurl=qqc.get_qwiz_param("ajaxurl",""));var o={action:"process_embeds",urls:encodeURIComponent(JSON.stringify(s)),args:encodeURIComponent(JSON.stringify(i))};$.ajax({type:"POST",async:!1,url:qwiz_ajaxurl,data:o,success:function(s){for(var i=0;i<r;i++){var a=s[i].replace(">",' data-embed="true">');e=e.replace(t[i],a)}}})}}return debug[0]&&console.log("[shortcodes_to_video_elements] htm:",e),e},this.isInteger=function(e){return(0^e)===e},this.bin2hex=function(e){var t,s,i,r="";for(t=0,s=(e+="").length;t<s;t++)r+=(i=e.charCodeAt(t).toString(16)).length<2?"0"+i:i;return r},$.fn.changeElements=function(e){return $(this).each(function(){var t={};$.each(this.attributes,function(e,s){t[s.nodeName]=s.nodeValue});var s=$("<"+e+"/>",t);$(this).replaceWith(s)}),$([])},this.metaphone=function(e,t){var s=typeof e;if("undefined"===s||"object"===s&&null!==e)return null;if("number"===s&&(isNaN(e)?e="NAN":isFinite(e)||(e="INF")),t<0)return!1;t=Math.floor(+t)||0;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=new RegExp("^[^"+i+"]+");if(!(e=(e="string"==typeof e?e:"").toUpperCase().replace(r,"")))return"";var a,o,_=function(e,t){return""!==t&&-1!==e.indexOf(t)},n=0,c=e.charAt(0),d=e.charAt(1),l=e.length,u="";switch(c){case"A":u+="E"===d?d:c,n+=1;break;case"G":case"K":case"P":"N"===d&&(u+=d,n+=2);break;case"W":"R"===d?(u+=d,n+=2):("H"===d||_("AEIOU",d))&&(u+="W",n+=2);break;case"X":u+="S",n+=1;break;case"E":case"I":case"O":case"U":u+=c,n++}for(;n<l&&(0===t||u.length<t);n+=1)if(c=e.charAt(n),d=e.charAt(n+1),o=e.charAt(n-1),a=e.charAt(n+2),c!==o||"C"===c)switch(c){case"B":"M"!==o&&(u+=c);break;case"C":_("EIY",d)?"I"===d&&"A"===a?u+="X":"S"!==o&&(u+="S"):"H"===d?(u+="X",n+=1):u+="K";break;case"D":"G"===d&&_("EIY",a)?(u+="J",n+=1):u+="T";break;case"G":"H"===d?_("BDH",e.charAt(n-3))||"H"===e.charAt(n-4)||(u+="F",n+=1):"N"===d?_(i,a)&&"NED"!==e.substr(n+1,3)&&(u+="K"):_("EIY",d)&&"G"!==o?u+="J":u+="K";break;case"H":_("AEIOU",d)&&!_("CGPST",o)&&(u+=c);break;case"K":"C"!==o&&(u+="K");break;case"P":u+="H"===d?"F":c;break;case"Q":u+="K";break;case"S":"I"===d&&_("AO",a)?u+="X":"H"===d?(u+="X",n+=1):u+="S";break;case"T":"I"===d&&_("AO",a)?u+="X":"H"===d?(u+="0",n+=1):"CH"!==e.substr(n+1,2)&&(u+="T");break;case"V":u+="F";break;case"W":case"Y":_("AEIOU",d)&&(u+=c);break;case"X":u+="KS";break;case"Z":u+="S";break;case"F":case"J":case"L":case"M":case"N":case"R":u+=c}return u}};qwiz_qcards_common_f.call(qwiz_qcards_common),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){var t=/\+/g;function s(e){return a.raw?e:encodeURIComponent(e)}function i(e){return s(a.json?JSON.stringify(e):String(e))}function r(s,i){var r=a.raw?s:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),a.json?JSON.parse(e):e}catch(e){}}(s);return e.isFunction(i)?i(r):r}var a=e.cookie=function(t,o,_){if(void 0!==o&&!e.isFunction(o)){if("number"==typeof(_=e.extend({},a.defaults,_)).expires){var n=_.expires,c=_.expires=new Date;c.setTime(+c+864e5*n)}return document.cookie=[s(t),"=",i(o),_.expires?"; expires="+_.expires.toUTCString():"",_.path?"; path="+_.path:"",_.domain?"; domain="+_.domain:"",_.secure?"; secure":""].join("")}for(var d,l=t?void 0:{},u=document.cookie?document.cookie.split("; "):[],p=0,h=u.length;p<h;p++){var g=u[p].split("="),q=(d=g.shift(),a.raw?d:decodeURIComponent(d)),m=g.join("=");if(t&&t===q){l=r(m,o);break}t||void 0===(m=r(m))||(l[q]=m)}return l};a.defaults={},e.removeCookie=function(t,s){return void 0!==e.cookie(t)&&(e.cookie(t,"",e.extend({},s,{expires:-1})),!e.cookie(t))}});var CryptoJS=CryptoJS||function(e,t){var s={},i=s.lib={},r=function(){},a=i.Base={extend:function(e){r.prototype=this;var t=new r;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||n).stringify(this)},concat:function(e){var t=this.words,s=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var r=0;r<e;r++)t[i+r>>>2]|=(s[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<s.length)for(r=0;r<e;r+=4)t[i+r>>>2]=s[r>>>2];else t.push.apply(t,s);return this.sigBytes+=e,this},clamp:function(){var t=this.words,s=this.sigBytes;t[s>>>2]&=4294967295<<32-s%4*8,t.length=e.ceil(s/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var s=[],i=0;i<t;i+=4)s.push(4294967296*e.random()|0);return new o.init(s,t)}}),_=s.enc={},n=_.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var s=[],i=0;i<e;i++){var r=t[i>>>2]>>>24-i%4*8&255;s.push((r>>>4).toString(16)),s.push((15&r).toString(16))}return s.join("")},parse:function(e){for(var t=e.length,s=[],i=0;i<t;i+=2)s[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new o.init(s,t/2)}},c=_.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var s=[],i=0;i<e;i++)s.push(String.fromCharCode(t[i>>>2]>>>24-i%4*8&255));return s.join("")},parse:function(e){for(var t=e.length,s=[],i=0;i<t;i++)s[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new o.init(s,t)}},d=_.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var s=this._data,i=s.words,r=s.sigBytes,a=this.blockSize,_=r/(4*a);if(t=(_=t?e.ceil(_):e.max((0|_)-this._minBufferSize,0))*a,r=e.min(4*t,r),t){for(var n=0;n<t;n+=a)this._doProcessBlock(i,n);n=i.splice(0,t),s.sigBytes-=r}return new o.init(n,r)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=l.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new u.HMAC.init(e,s).finalize(t)}}});var u=s.algo={};return s}(Math);!function(e){var t,s=(t=CryptoJS).lib,i=s.Base,r=s.WordArray;(t=t.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,s=[],i=0;i<t;i++){var a=e[i];s.push(a.high),s.push(a.low)}return r.create(s,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),s=t.length,r=0;r<s;r++)t[r]=t[r].clone();return e}})}(),function(e){for(var t=CryptoJS,s=(a=t.lib).WordArray,i=a.Hasher,r=t.x64.Word,a=t.algo,o=[],_=[],n=[],c=1,d=0,l=0;24>l;l++){o[c+5*d]=(l+1)*(l+2)/2%64;var u=(2*c+3*d)%5;c=d%5,d=u}for(c=0;5>c;c++)for(d=0;5>d;d++)_[c+5*d]=d+(2*c+3*d)%5*5;for(c=1,d=0;24>d;d++){for(var p=u=l=0;7>p;p++){if(1&c){var h=(1<<p)-1;32>h?u^=1<<h:l^=1<<h-32}c=128&c?c<<1^113:c<<1}n[d]=r.create(l,u)}var g=[];for(c=0;25>c;c++)g[c]=r.create();a=a.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;25>t;t++)e[t]=new r.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var s=this._state,i=this.blockSize/2,r=0;r<i;r++){var a=16711935&((a=e[t+2*r])<<8|a>>>24)|4278255360&(a<<24|a>>>8),c=16711935&((c=e[t+2*r+1])<<8|c>>>24)|4278255360&(c<<24|c>>>8),d=s[r];d.high^=c,d.low^=a}for(i=0;24>i;i++){for(r=0;5>r;r++){for(var l=a=0,u=0;5>u;u++)a^=(d=s[r+5*u]).high,l^=d.low;(d=g[r]).high=a,d.low=l}for(r=0;5>r;r++)for(d=g[(r+4)%5],c=(a=g[(r+1)%5]).high,u=a.low,a=d.high^(c<<1|u>>>31),l=d.low^(u<<1|c>>>31),u=0;5>u;u++)(d=s[r+5*u]).high^=a,d.low^=l;for(c=1;25>c;c++)r=(d=s[c]).high,d=d.low,32>(u=o[c])?(a=r<<u|d>>>32-u,l=d<<u|r>>>32-u):(a=d<<u-32|r>>>64-u,l=r<<u-32|d>>>64-u),(d=g[_[c]]).high=a,d.low=l;for(d=g[0],r=s[0],d.high=r.high,d.low=r.low,r=0;5>r;r++)for(u=0;5>u;u++)d=s[c=r+5*u],a=g[c],c=g[(r+1)%5+5*u],l=g[(r+2)%5+5*u],d.high=a.high^~c.high&l.high,d.low=a.low^~c.low&l.low;d=s[0],r=n[i],d.high^=r.high,d.low^=r.low}},_doFinalize:function(){var t=(a=this._data).words,i=8*a.sigBytes,r=32*this.blockSize;t[i>>>5]|=1<<24-i%32,t[(e.ceil((i+1)/r)*r>>>5)-1]|=128,a.sigBytes=4*t.length,this._process();for(var a=this._state,o=(i=(t=this.cfg.outputLength/8)/8,r=[],0);o<i;o++){var _=16711935&((_=(n=a[o]).high)<<8|_>>>24)|4278255360&(_<<24|_>>>8),n=16711935&((n=n.low)<<8|n>>>24)|4278255360&(n<<24|n>>>8);r.push(n),r.push(_)}return new s.init(r,t)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),s=0;25>s;s++)t[s]=t[s].clone();return e}}),t.SHA3=i._createHelper(a),t.HmacSHA3=i._createHmacHelper(a)}(Math);var DateFormat={};!function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=["January","February","March","April","May","June","July","August","September","October","November","December"],a={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},o=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[Z\-+]?(\d{2}:?\d{2})?/;DateFormat.format=function(){function e(e){return t[parseInt(e,10)]||e}function _(e){return s[parseInt(e,10)]||e}function n(e){var t=parseInt(e,10)-1;return i[t]||e}function c(e){var t=parseInt(e,10)-1;return r[t]||e}function d(e){return a[e]||e}function l(e){var t,s,i,r,a,o=e,_="";return-1!==o.indexOf(".")&&(r=o.split("."),o=r[0],_=r[1]),3===(a=o.split(":")).length?(t=a[0],s=a[1],i=a[2].replace(/\s.+/,"").replace(/[a-z]/gi,""),{time:o=o.replace(/\s.+/,"").replace(/[a-z]/gi,""),hour:t,minute:s,second:i,millis:_}):{time:"",hour:"",minute:"",second:"",millis:""}}function u(e,t){for(var s=t-String(e).length,i=0;i<s;i++)e="0"+e;return e}return{parseDate:function(e){var t={date:null,year:null,month:null,dayOfMonth:null,dayOfWeek:null,time:null};if("number"==typeof e)return this.parseDate(new Date(e));if("function"==typeof e.getFullYear)t.year=String(e.getFullYear()),t.month=String(e.getMonth()+1),t.dayOfMonth=String(e.getDate()),t.time=l(e.toTimeString()+"."+e.getMilliseconds());else if(-1!=e.search(o))values=e.split(/[T\+-]/),t.year=values[0],t.month=values[1],t.dayOfMonth=values[2],t.time=l(values[3].split(".")[0]);else switch(values=e.split(" "),6===values.length&&isNaN(values[5])&&(values[values.length]="()"),values.length){case 6:t.year=values[5],t.month=d(values[1]),t.dayOfMonth=values[2],t.time=l(values[3]);break;case 2:subValues=values[0].split("-"),t.year=subValues[0],t.month=subValues[1],t.dayOfMonth=subValues[2],t.time=l(values[1]);break;case 7:case 9:case 10:t.year=values[3],t.month=d(values[1]),t.dayOfMonth=values[2],t.time=l(values[4]);break;case 1:subValues=values[0].split(""),t.year=subValues[0]+subValues[1]+subValues[2]+subValues[3],t.month=subValues[5]+subValues[6],t.dayOfMonth=subValues[8]+subValues[9],t.time=l(subValues[13]+subValues[14]+subValues[15]+subValues[16]+subValues[17]+subValues[18]+subValues[19]+subValues[20]);break;default:return null}return t.time?t.date=new Date(t.year,t.month-1,t.dayOfMonth,t.time.hour,t.time.minute,t.time.second,t.time.millis):t.date=new Date(t.year,t.month-1,t.dayOfMonth),t.dayOfWeek=String(t.date.getDay()),t},date:function(t,s){try{var i=this.parseDate(t);if(null===i)return t;i.date;for(var r=i.year,a=i.month,o=i.dayOfMonth,d=i.dayOfWeek,l=i.time,p="",h="",g="",q=!1,m=0;m<s.length;m++){var w=s.charAt(m),f=s.charAt(m+1);if(q)"'"==w?(h+=""===p?"'":p,p="",q=!1):p+=w;else switch(g="",p+=w){case"ddd":h+=e(d),p="";break;case"dd":if("d"===f)break;h+=u(o,2),p="";break;case"d":if("d"===f)break;h+=parseInt(o,10),p="";break;case"D":h+=o=1==o||21==o||31==o?parseInt(o,10)+"st":2==o||22==o?parseInt(o,10)+"nd":3==o||23==o?parseInt(o,10)+"rd":parseInt(o,10)+"th",p="";break;case"MMMM":h+=c(a),p="";break;case"MMM":if("M"===f)break;h+=n(a),p="";break;case"MM":if("M"===f)break;h+=u(a,2),p="";break;case"M":if("M"===f)break;h+=parseInt(a,10),p="";break;case"y":case"yyy":if("y"===f)break;h+=p,p="";break;case"yy":if("y"===f)break;h+=String(r).slice(-2),p="";break;case"yyyy":h+=r,p="";break;case"HH":h+=u(l.hour,2),p="";break;case"H":if("H"===f)break;h+=parseInt(l.hour,10),p="";break;case"hh":hour=0===parseInt(l.hour,10)?12:l.hour<13?l.hour:l.hour-12,h+=u(hour,2),p="";break;case"h":if("h"===f)break;hour=0===parseInt(l.hour,10)?12:l.hour<13?l.hour:l.hour-12,h+=parseInt(hour,10),p="";break;case"mm":h+=u(l.minute,2),p="";break;case"m":if("m"===f)break;h+=l.minute,p="";break;case"ss":h+=u(l.second.substring(0,2),2),p="";break;case"s":if("s"===f)break;h+=l.second,p="";break;case"S":case"SS":if("S"===f)break;h+=p,p="";break;case"SSS":h+=l.millis.substring(0,3),p="";break;case"a":h+=l.hour>=12?"PM":"AM",p="";break;case"p":h+=l.hour>=12?"p.m.":"a.m.",p="";break;case"E":h+=_(d),p="";break;case"'":p="",q=!0;break;default:h+=w,p=""}}return h+=g}catch(e){return console&&console.log&&console.log(e),t}},toBrowserTimeZone:function(e,t){return this.date(new Date(e),t||"MM/dd/yyyy HH:mm:ss")}}}()}(),function(){"use strict";var e="object"==typeof window?window:{};!e.JS_CRC_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node&&(e=global);var t,s,i,r,a=!e.JS_CRC_NO_COMMON_JS&&"object"==typeof module&&module.exports,o="function"==typeof define&&define.amd,_=!e.JS_CRC_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,n="0123456789abcdef".split(""),c=[{name:"qwiz_crc32",polynom:3988292384,initValue:-1,bytes:4},{name:"qwiz_crc16",polynom:40961,initValue:0,bytes:2}];for(t=0;t<c.length;++t){for((u=c[t]).method=function(e){return function(t){return d(t,e)}}(u),u.table=[],s=0;256>s;++s){for(r=s,i=0;8>i;++i)r=1&r?u.polynom^r>>>1:r>>>1;u.table[s]=r>>>0}}var d=function(e,t){var s="string"!=typeof e;s&&_&&e instanceof ArrayBuffer&&(e=new Uint8Array(e));var i,r,a=t.initValue,o=e.length,c=t.table;if(s)for(r=0;o>r;++r)a=c[255&(a^e[r])]^a>>>8;else for(r=0;o>r;++r)128>(i=e.charCodeAt(r))?a=c[255&(a^i)]^a>>>8:2048>i?a=c[255&((a=c[255&(a^(192|i>>6))]^a>>>8)^(128|63&i))]^a>>>8:55296>i||i>=57344?a=c[255&((a=c[255&((a=c[255&(a^(224|i>>12))]^a>>>8)^(128|i>>6&63))]^a>>>8)^(128|63&i))]^a>>>8:a=c[255&((a=c[255&((a=c[255&((a=c[255&(a^(240|(i=65536+((1023&i)<<10|1023&e.charCodeAt(++r)))>>18))]^a>>>8)^(128|i>>12&63))]^a>>>8)^(128|i>>6&63))]^a>>>8)^(128|63&i))]^a>>>8;a^=t.initValue;var d="";return t.bytes>2&&(d+=n[a>>28&15]+n[a>>24&15]+n[a>>20&15]+n[a>>16&15]),d+(n[a>>12&15]+n[a>>8&15]+n[a>>4&15]+n[15&a])},l={};for(t=0;t<c.length;++t){l[(u=c[t]).name]=u.method}if(a)module.exports=l;else{for(t=0;t<c.length;++t){var u;e[(u=c[t]).name]=u.method}o&&define(function(){return l})}}(),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e,t){var s="plugin_hideShowPassword",i=["show","innerToggle"],r=function(){var e=document.body,t=document.createElement("input"),s=!0;e||(e=document.createElement("body")),t=e.appendChild(t);try{t.setAttribute("type","text")}catch(e){s=!1}return e.removeChild(t),s}();function a(t,s){this.element=e(t),this.wrapperElement=e(),this.toggleElement=e(),this.init(s)}a.prototype={init:function(t){this.update(t,e.fn.hideShowPassword.defaults)&&(this.element.addClass(this.options.className),this.options.innerToggle&&(this.wrapElement(this.options.wrapper),this.initToggle(this.options.toggle),"string"==typeof this.options.innerToggle&&(this.toggleElement.hide(),this.element.one(this.options.innerToggle,e.proxy(function(){this.toggleElement.show()},this)))),this.element.trigger(this.options.initEvent,[this]))},update:function(e,t){return this.options=this.prepareOptions(e,t),this.updateElement()&&this.element.trigger(this.options.changeEvent,[this]).trigger(this.state().changeEvent,[this]),this.options.enable},toggle:function(e){return e=e||"toggle",this.update({show:e})},prepareOptions:function(t,s){var i,r=t||{},a=[];if(s=s||this.options,t=e.extend(!0,{},s,t),r.hasOwnProperty("wrapper")&&r.wrapper.hasOwnProperty("inheritStyles")&&(t.wrapper.inheritStyles=r.wrapper.inheritStyles),t.enable&&("toggle"===t.show?t.show=this.isType("hidden",t.states):"infer"===t.show&&(t.show=this.isType("shown",t.states)),"infer"===t.toggle.position&&(t.toggle.position="rtl"===this.element.css("text-direction")?"left":"right"),!e.isArray(t.toggle.attachToKeyCodes))){if(!0===t.toggle.attachToKeyCodes)switch((i=e(t.toggle.element)).prop("tagName").toLowerCase()){case"button":case"input":break;case"a":if(i.filter("[href]").length){a.push(32);break}default:a.push(32,13)}t.toggle.attachToKeyCodes=a}return t},updateElement:function(){return!(!this.options.enable||this.isType())&&(this.element.prop(e.extend({},this.options.props,this.state().props)).addClass(this.state().className).removeClass(this.otherState().className),this.options.triggerOnToggle&&this.element.trigger(this.options.triggerOnToggle,[this]),this.updateToggle(),!0)},isType:function(e,s){return(s=s||this.options.states)[e=e||this.state(t,t,s).props.type]&&(e=s[e].props.type),this.element.prop("type")===e},state:function(e,s,i){return i=i||this.options.states,e===t&&(e=this.options.show),"boolean"==typeof e&&(e=e?"shown":"hidden"),s&&(e="shown"===e?"hidden":"shown"),i[e]},otherState:function(e){return this.state(e,!0)},wrapElement:function(t){var s,i=t.enforceWidth;return this.wrapperElement.length||(s=this.element.outerWidth(),e.each(t.inheritStyles,e.proxy(function(e,s){t.styles[s]=this.element.css(s)},this)),this.element.css(t.innerElementStyles).wrap(e(t.element).addClass(t.className).css(t.styles)),this.wrapperElement=this.element.parent(),!0===i&&(i=this.wrapperElement.outerWidth()!==s&&s),!1!==i&&this.wrapperElement.css("width",i)),this.wrapperElement},initToggle:function(t){return this.toggleElement.length||(this.toggleElement=e(t.element).attr(t.attr).addClass(t.className).css(t.styles).appendTo(this.wrapperElement),this.updateToggle(),this.positionToggle(t.position,t.verticalAlign,t.offset),t.touchSupport?(this.toggleElement.css(t.touchStyles),this.element.on(t.attachToTouchEvent,e.proxy(this.toggleTouchEvent,this))):this.toggleElement.on(t.attachToEvent,e.proxy(this.toggleEvent,this)),t.attachToKeyCodes.length&&this.toggleElement.on(t.attachToKeyEvent,e.proxy(this.toggleKeyEvent,this))),this.toggleElement},positionToggle:function(e,t,s){var i={};switch(i[e]=s,t){case"top":case"bottom":i[t]=s;break;case"middle":i.top="50%",i.marginTop=this.toggleElement.outerHeight()/-2}return this.toggleElement.css(i)},updateToggle:function(e,t){var s,i;return this.toggleElement.length&&(s="padding-"+this.options.toggle.position,e=e||this.state().toggle,t=t||this.otherState().toggle,this.toggleElement.attr(e.attr).addClass(e.className).removeClass(t.className).html(e.content),i=this.toggleElement.outerWidth()+2*this.options.toggle.offset,this.element.css(s)!==i&&this.element.css(s,i)),this.toggleElement},toggleEvent:function(e){e.preventDefault(),this.toggle()},toggleKeyEvent:function(t){e.each(this.options.toggle.attachToKeyCodes,e.proxy(function(e,s){if(t.which===s)return this.toggleEvent(t),!1},this))},toggleTouchEvent:function(e){var t,s,i,r=this.toggleElement.offset().left;r&&(t=e.pageX||e.originalEvent.pageX,"left"===this.options.toggle.position?(s=t,i=r+=this.toggleElement.outerWidth()):(s=r,i=t),i>=s&&this.toggleEvent(e))}},e.fn.hideShowPassword=function(){var t={};return e.each(arguments,function(s,r){var a={};if("object"==typeof r)a=r;else{if(!i[s])return!1;a[i[s]]=r}e.extend(!0,t,a)}),this.each(function(){var i=e(this),r=i.data(s);r?r.update(t):i.data(s,new a(this,t))})},e.each({show:!0,hide:!1,toggle:"toggle"},function(t,s){e.fn[t+"Password"]=function(e,t){return this.hideShowPassword(s,e,t)}}),e.fn.hideShowPassword.defaults={show:"infer",innerToggle:!1,enable:r,triggerOnToggle:!1,className:"hideShowPassword-field",initEvent:"hideShowPasswordInit",changeEvent:"passwordVisibilityChange",props:{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:"false"},toggle:{element:'<button type="button">',className:"hideShowPassword-toggle",touchSupport:"undefined"!=typeof Modernizr&&Modernizr.touchevents,attachToEvent:"click.hideShowPassword",attachToTouchEvent:"touchstart.hideShowPassword mousedown.hideShowPassword",attachToKeyEvent:"keyup",attachToKeyCodes:!0,styles:{position:"absolute"},touchStyles:{pointerEvents:"none"},position:"infer",verticalAlign:"middle",offset:0,attr:{tabindex:"-1",role:"button","aria-label":"Show password",title:"Show password",tabIndex:0}},wrapper:{element:"<div>",className:"hideShowPassword-wrapper",enforceWidth:!0,styles:{position:"relative"},inheritStyles:["display","verticalAlign","marginTop","marginRight","marginBottom","marginLeft"],innerElementStyles:{marginTop:0,marginRight:0,marginBottom:0,marginLeft:0}},states:{shown:{className:"hideShowPassword-shown",changeEvent:"passwordShown",props:{type:"text"},toggle:{className:"hideShowPassword-toggle-hide",content:"Hide",attr:{tabindex:"-1","aria-pressed":"true",title:"Hide password"}}},hidden:{className:"hideShowPassword-hidden",changeEvent:"passwordHidden",props:{type:"password"},toggle:{className:"hideShowPassword-toggle-show",content:"Show",attr:{tabindex:"-1","aria-pressed":"false",title:"Show password"}}}}}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window).base64js=e()}}(function(){return function(){return function e(t,s,i){function r(o,_){if(!s[o]){if(!t[o]){var n="function"==typeof require&&require;if(!_&&n)return n(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=s[o]={exports:{}};t[o][0].call(d.exports,function(e){return r(t[o][1][e]||e)},d,d.exports,e,t,s,i)}return s[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}}()({"/":[function(e,t,s){"use strict";function i(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");return-1===s&&(s=t),[s,s===t?0:4-s%4]}function r(e){return o[63&e>>18]+o[63&e>>12]+o[63&e>>6]+o[63&e]}function a(e,t,s){for(var i,a=[],o=t;o<s;o+=3)i=(16711680&e[o]<<16)+(65280&e[o+1]<<8)+(255&e[o+2]),a.push(r(i));return a.join("")}s.byteLength=function(e){var t=i(e),s=t[0],r=t[1];return 3*(s+r)/4-r},s.toByteArray=function(e){var t,s,r=i(e),a=r[0],o=r[1],c=new n(function(e,t,s){return 3*(t+s)/4-s}(0,a,o)),d=0,l=0<o?a-4:a;for(s=0;s<l;s+=4)t=_[e.charCodeAt(s)]<<18|_[e.charCodeAt(s+1)]<<12|_[e.charCodeAt(s+2)]<<6|_[e.charCodeAt(s+3)],c[d++]=255&t>>16,c[d++]=255&t>>8,c[d++]=255&t;return 2===o&&(t=_[e.charCodeAt(s)]<<2|_[e.charCodeAt(s+1)]>>4,c[d++]=255&t),1===o&&(t=_[e.charCodeAt(s)]<<10|_[e.charCodeAt(s+1)]<<4|_[e.charCodeAt(s+2)]>>2,c[d++]=255&t>>8,c[d++]=255&t),c},s.fromByteArray=function(e){for(var t,s=e.length,i=s%3,r=[],_=16383,n=0,c=s-i;n<c;n+=_)r.push(a(e,n,n+_>c?c:n+_));return 1===i?(t=e[s-1],r.push(o[t>>2]+o[63&t<<4]+"==")):2===i&&(t=(e[s-2]<<8)+e[s-1],r.push(o[t>>10]+o[63&t>>4]+o[63&t<<2]+"=")),r.join("")};for(var o=[],_=[],n="undefined"==typeof Uint8Array?Array:Uint8Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,l=c.length;d<l;++d)o[d]=c[d],_[c.charCodeAt(d)]=d;_[45]=62,_[95]=63},{}]},{},[])("/")});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,s,i,r,a,o,_,n="",c=0;for(e=Base64._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(s=e.charCodeAt(c++))>>4,o=(15&s)<<2|(i=e.charCodeAt(c++))>>6,_=63&i,isNaN(s)?o=_=64:isNaN(i)&&(_=64),n=n+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(_);return n},decode:function(e){var t,s,i,r,a,o,_="",n=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");n<e.length;)t=this._keyStr.indexOf(e.charAt(n++))<<2|(r=this._keyStr.indexOf(e.charAt(n++)))>>4,s=(15&r)<<4|(a=this._keyStr.indexOf(e.charAt(n++)))>>2,i=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(n++))),_+=String.fromCharCode(t),64!=a&&(_+=String.fromCharCode(s)),64!=o&&(_+=String.fromCharCode(i));return _=Base64._utf8_decode(_)},_utf8_encode:function(e){var t="";e=e.replace(/\r\n/g,"\n");for(var s=0;s<e.length;s++){var i=e.charCodeAt(s);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){var t,s,i,r="",a=0;for(t=s=0;a<e.length;)(t=e.charCodeAt(a))<128?(r+=String.fromCharCode(t),a++):t>191&&t<224?(s=e.charCodeAt(a+1),r+=String.fromCharCode((31&t)<<6|63&s),a+=2):(s=e.charCodeAt(a+1),i=e.charCodeAt(a+2),r+=String.fromCharCode((15&t)<<12|(63&s)<<6|63&i),a+=3);return r}};